---
title: "Vetores Aleatórios"
lang: pt # Equações ficarem referenciadas em Português
toc: true
toc-title: "Nesta página"
toc-location: right
execute: 
  warning: false
  message: false
format:
  html:
    code-fold: true
    code-summary: "Mostrar Código"
---

# Introdução

**Definição** (@rolla2021intprob) Um *vetor aleatório* $(X_1, ..., X_p)$ é uma função $X: \Omega \rightarrow \mathbb{R}^p$ tal que cada coordenada $X_i$ é uma variável aleatória.

Importante destacar que a notação para vetor aleatório pode variar de acordo com o autor. Podemos encontrar a notação como $\textbf{X}$ (isto é, em negrito conforme @magalhaes2006probabilidade), $\overset{\sim}{X}$ ou, ainda, $\underset{\sim}{X}$ (@barryjames2023).

<!-- função utilde do latex não disponível sem um usepackage(undertilde), por isso optei pelo overset com \sim  -->

## Vetores Aleatórios Discretos

### Distribuições de Probabilidade

**Definição** A distribuição de probabilidade do vetor aleatório $\textbf{X} = (X_1, X_2, ..., X_p)$ é uma tabela que associa a cada valor $(x_1, x_2, ..., x_p)$ desse vetor sua correspondente probabilidade $P([X_1 = x_1, X_2 = x_2, ..., X_p = x_p])$. Ela é denominada também distribuição conjunta de $X_1, X_2, ..., X_p$.

Observemos que a notação $[X_1 = x_1, X_2 = x_2, ..., X_p = x_p]$ representa a intersecção dos eventos $[X_1 = x_1], [X_2 = x_2], ..., [X_p = x_p]$ ou seja,

$$
\begin{align*}
[X_1 = x_1, X_2 = x_2, ..., X_p = x_p] &= \{ \omega: X_1(\omega) = x_1, X_2(\omega) = x_2, ..., X_p(\omega) = x_p \} = \\ &= \{ \omega: X_1(\omega) = x_1 \} \cap \{ \omega: X_2(\omega) = x_2 \} \cap ...  \cap \{ \omega: X_p(\omega) = x_p \}
\end{align*}
$$

Uma notação alternativa para $P([X_1 = x_1, X_2 = x_2, ..., X_p = x_p])$ é $P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)$.

**Exemplo** Lançamento de dois dados honestos. Seja $X_1$ o valor da face do primeiro dado e $X_2$ o valor da face do segundo dado a distribuição conjunta do vetor aleatório $(X_1, X_2)$ é dada por

![Distribuição Conjunta de Dois Dados Honestos](figs/tabela_dados.png)

**Exemplo** Lançamento de um dado e uma moeda, ambos honestos. Seja $X$ o valor da face do primeiro dado e $Y$ a variável aleatória da moeda sendo $Y = 1$ se "cara" e $Y = 0$ se "coroa". Então, a distribuição conjunta do vetor aleatório $(X, Y)$ é dada por

![Distribuição Conjunta de Um Dado e Uma Moeda Honestos](figs/tabela_dado_moeda.png)

**Definição** (@dantas2013probabilidade) A função de distribuição do par de variáveis aleatórias discretas $(X,Y)$ é dada por:

$$
F(x,y) = P(X \le x, Y \le y) = \sum_{i: x_i \le x}\sum_{j: y_j \le j} P(X = x_i, Y = y_i)
$$

Uma notação alternativa para $F(x,y)$ é $F_{X,Y}(x,y)$.

### Distribuições Marginais

A distribuição marginal de uma variável aleatória específica é dada ao somarmos as probabilidades "varrendo" todo o intervalo de todas as demais variáveis do vetor aleatório. Por exemplo, assuma que em um vetor aleatório $(X,Y)$, $X$ assume os valores $x_1, x_2, ..., x_n$ enquanto $Y$ assume os valores $y_1, y_2, ..., y_m$. Então, a ditribuição marginal de X é dada por

$$
P(X = x_i) = \sum_{j = 1}^{m} = P(X = x_i, Y = y_j).
$$

Analogamente, a dstribuição marginal de $Y$ é obtida através de

$$
P(Y = y_j) = \sum_{i = 1}^{n} = P(X = x_i, Y = y_j).
$$

Abaixo, destacado em vermelho seguem as distribuições marginais do exemplo anterior:

![Distribuição Conjunta de Um Dado e Uma Moeda Honestos com distribuições marginais](figs/tabela_dado_moeda_marginal.png)

Para o caso multidimensional (ou seja, $p$-dimensional), o procedimento é análogo.

Seja $\textbf{X} = (X_1, X_2, ..., X_p)$ um vetor aleatório com distribuição conjunta dada por: $P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)$, onde $x_1, x_2, ..., x_p$, percorrem o conjunto de valores de $X_1, X_2, ..., X_p$, respectivamente.

A distribuição marginal de $X_1$ é obtida calculando-se, para cada valor $x_1$ de $X_1$:

$$
P(X_1 = x_1) = \sum_{x_2} \dots \sum_{x_p} P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)
$$

Analogamente, para obter a marginal de qualquer subconjunto de $(X_1, X_2, ..., X_p)$, fazemos o somatório percorrendo o subconjunto complementar. Por exemplo, para a marginal de $(X_1, X_2)$, tem-se:

$$
P(X_1 = x_1, X_2 = x_2) = \sum_{x_3} \sum_{x_4} \dots \sum_{x_p} P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)
$$

### Vetores Aleatórios Independentes

**Definição** As variáveis aleatórias $X_1, X_2, ..., X_p$ são ditas independentes se para todos os elementos $x_1, x_2, ..., x_p$ das mesmas tivermos:

$$
P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p) = P(X_1 = x_1)P(X_2 = x_2)...P(X_p = x_p).
$$

Ou seja, se as variáveis são independentes, então a distribuição conjunta é o produto das marginais.

**Lema** As variáveis $X$ e $Y$ com função de distribuição $F_{X,Y}(x,y)$ são independentes se, e somente se

$$
F_{X,Y}(x,y) = F_{X}(x)F_{Y}(y)
$$

**Prova**

Ida:

$$
\begin{align*}
F_{X,Y}(x,y) &= \sum_{i: x_i \le x}\sum_{j: y_j \le j} P(X = x_i, Y = y_i) \overset{\text{Definição de Indep.}}{=} \sum_{i: x_i \le x}\sum_{j: y_j \le j} P(X = x_i)P(Y = y_i) \overset{\text{Separa Somatórios}}{=} \\ &= \underbrace{\sum_{i: x_i \le x}P(X = x_i)}_{F_{X}(x)}  \underbrace{\sum_{j: y_j \le j}P(Y = y_i)}_{F_{Y}(y)} = F_X(x)F_Y(y)
\end{align*}
$$

Volta:

$$
\begin{align*}
F_X(x)F_Y(y) &= \sum_{i: x_i \le x}P(X = x_i) \sum_{j: y_j \le j}P(Y = y_i) \overset{\text{Combina Somatórios}}{=} \sum_{i: x_i \le x}\sum_{j: y_j \le j} P(X = x_i)P(Y = y_i) \overset{\text{Definição de Indep.}}{=} \\ &= \sum_{i: x_i \le x}\sum_{j: y_j \le j} P(X = x_i, Y = y_i) = F_{X,Y}(x,y)
\end{align*}
$$

$\square$

### Distribuições Condicionais

**Definição** A distribuição condicional de $Y$ dado $X$ associa a cada valor $x$ de $X$ uma distribuição de probabilidade sobre os valores de $Y$, da seguinte maneira:

$$
P(Y = x | X = x) = \frac{P(X = x, Y = y)}{P(X = x)}
$$

Note que isso se refere à distribuição condicional de $Y$ dado $X$, estamos nos referindo ao conjunto de *todas as distribuições condicionais* associadas a cada um dos valores de $X$.

## Vetores Aleatórios Contínuos

### Distribuições de Probabilidade

**Definição** Uma função $f(x,y)$ definida para $- \infty < x < + \infty$, $- \infty < y < + \infty$, não-negativa e satisfazendo a condição

$$
\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty}f(x,y)dxdy=1
$$

é denominada uma função densidade de probabilidade da variável aleatória bidimensional $(X,Y)$ se para todo o subconjunto $B$ de pontos do $\mathbb{R}^2$ tivermos:

$$
P((X,Y) \in B) = \int\int_{B}f(x,y)dxdy
$$

Segundo @dantas2013probabilidade, a interpretação da função densidade de probabilidade no caso bidimensional é a seguinte: seja $(x,y)$ um ponto do plano e consideremos um retângulo de lados $\Delta x$ e $\Delta y$ construído a partir do ponto $(x,y)$. A probabilidade de que $(X,Y)$ pertença a esse retângulo é aproximadamente igual ao volume do paralelepípedo de lados $\Delta x$ e $\Delta y$ e cuja altura é $f(x,y)$, ou seja,

![Construção de probabilidade de uma distribuição conjunta bidimensional (Extraído de @dantas2013probabilidade)](figs/bidimensional_deltas.png){width="50%"}

Abaixo, seguem alguns exemplos visuais tridimensionais:

**Exemplo** Função bidimensional com área destacada *entre dois valores de cada variável*:

Suponha a densidade

$$
f(x,y) = 9x^2y^2, \quad 0 \le x,y \le 1,
$$

Suponha o cálculo de probabilidade do tipo:

$$
P(c \le X \le d, \; e \le Y \le f) \;=\; 
\int_c^d \int_e^f 9x^2 y^2 \, dy \, dx.
$$

Essa integral tem solução fechada:

$$
P = (d^3 - c^3)\,(f^3 - e^3).
$$

Vamos calcular e ilustrar o valor da probabilidade $P(0.2 \le X \le 0.6, 0.3 \le Y \le 0.8)$:

```{r}
# Distribuição montanhosa f(x,y) = 9x^2 y^2
if (!requireNamespace("plotly", quietly = TRUE)) install.packages("plotly")
if (!requireNamespace("ggplot2", quietly = TRUE)) install.packages("ggplot2")

library(plotly)
library(ggplot2)

# --- Intervalos ---
c1 <- 0.2; d1 <- 0.6   # intervalo para X
e1 <- 0.3; f1 <- 0.8   # intervalo para Y

# Função densidade
f_xy <- function(x, y) 9 * x^2 * y^2

# Probabilidade analítica
prob_interval <- (d1^3 - c1^3) * (f1^3 - e1^3)
cat(sprintf("Probabilidade P(%.2f <= X <= %.2f, %.2f <= Y <= %.2f) = %.4f\n",
            c1, d1, e1, f1, prob_interval))

```

```{r}
# --- Grid para visualização ---
x_seq <- seq(0, 1, length.out = 80)
y_seq <- seq(0, 1, length.out = 80)
Z <- outer(x_seq, y_seq, f_xy)

# Máscara região do intervalo
mask_region <- outer(x_seq, y_seq, function(x, y) (x >= c1 & x <= d1 & y >= e1 & y <= f1))

# --- Gráfico 3D ---
p3d <- plot_ly(showscale = FALSE) %>%
  add_surface(x = x_seq, y = y_seq, z = Z,
              opacity = 0.6, name = "densidade") %>%
  add_surface(x = x_seq, y = y_seq,
              z = ifelse(mask_region, Z, NA),
              opacity = 1.0, name = "região do intervalo") %>%
  layout(title = "Distribuição f(x,y) = 9x²y² com intervalo destacado",
         scene = list(xaxis = list(title = "X"),
                      yaxis = list(title = "Y"),
                      zaxis = list(title = "densidade")))

p3d
```

**Exemplo** Normal Bivariada

```{r}
# --- Dependências (instalar se não estiverem disponíveis) ---
pacotes <- c("mvtnorm", "plotly")
nao_instalados <- pacotes[!pacotes %in% installed.packages()[, "Package"]]
if(length(nao_instalados)) install.packages(nao_instalados, repos = "https://cloud.r-project.org")

library(mvtnorm)  # para dmvnorm
library(plotly)   # para superfície 3D interativa

# --- Parâmetros da normal bivariada ---
mu <- c(0, 0)                         # vetor de médias
Sigma <- matrix(c(1.0, 0.6,           # matriz de covariância com correlação
                  0.6, 1.0), ncol=2)

# --- Grade onde avaliamos a densidade ---
x_seq <- seq(-3, 3, length.out = 121)
y_seq <- seq(-3, 3, length.out = 121)
grade <- expand.grid(x = x_seq, y = y_seq)

# Avaliar densidade bivariada na grade
dens <- dmvnorm(grade, mean = mu, sigma = Sigma)
z_mat <- matrix(dens, nrow = length(x_seq), ncol = length(y_seq))

# --- Superfície 3D interativa com plotly ---
p <- plot_ly(x = x_seq, y = y_seq, z = ~z_mat, showscale = TRUE) %>%
  add_surface() %>%
  layout(title = "Densidade Normal Bivariada (interativa)",
         scene = list(
           xaxis = list(title = "X1"),
           yaxis = list(title = "X2"),
           zaxis = list(title = "Densidade")
         ))
# Aparece no Viewer do RStudio ou no navegador
p
```

**Definição** (@dantas2013probabilidade) A função de distribuição de uma variável aleatória bidimensional $(X,Y)$ é dada por:

$$
F(x,y) = P(X \le x, Y \le y), \quad x \in \mathbb{R}, y \in \mathbb{R}
$$

Uma notação alternativa para $F(x,y)$ é $F_{X,Y}(x,y)$.

No caso de variáveis aleatórias contínuas $X$ e $Y$, a probabilidade do evento $[X \le x, Y \le, y]$ é igual ao valor da integral da densidade conjunta de $(X, Y)$ no conjunto $B = [X \le x, Y \le, y]$

$$
F(x,y) = \int_{-\infty}^{x}\int_{-\infty}^{y} f(u,v) dudv
$$

Ou com uma notação alternativa:

$$
F_{X,Y}(x,y) = \int_{-\infty}^{x}\int_{-\infty}^{y} f_{X,Y}(u,v) dudv
$$

### Distribuições Marginais

Dada a densidade conjunta das variáveis $X$ e $Y$, podemos determinar as densidades de $X$ e de $Y$ isoladamente. Essas densidades são chamadas de densidades marginais $f_X(x)$ e $f_Y(x)$, respectivamente. Elas são obtidas através da seguinte maneira:

$$
\begin{align*}
f_X(x) = \int_{-\infty}^{+\infty} f(x,y) dy \\
f_Y(y) = \int_{-\infty}^{+\infty} f(x,y) dx
\end{align*}
$$

Para o caso multivariado, por exemplo para o vetor aleatório $(X_1, X_2, ..., X_p)$ para obter uma marginal em específico, por exemplo, $X_1$ integramos em relação à todas às demais, isto é:

$$
f_{X_1}(x_1) = \overbrace{\int_{-\infty}^{+\infty}\int_{-\infty}^{+\infty} ... \int_{-\infty}^{+\infty}}^{\text{p-1 integrais}} f(x_1, x_2, ..., x_p) dx_2dx_3...dx_p
$$

### Vetores Aleatórios Independentes

**Definição** As variáveis aleatórias $X$ e $Y$, cuja densidade conjunta é $f(x,y)$, para $x,y \in \mathbb{R}$, e cujas densidades marginais são denotadas $f_X(x)$ e $f_Y(y)$, são ditas independentes se para todo o par de valores $(x,y)$ tivermos

$$
f(x,y) = f_X(x)f_Y(y)
$$

E no caso $p$-dimensional:

$$
f_{\textbf{X}}(x_1,x_2, ..., x_p) = f_{X_1}(x_1)f_{X_2}(x_2)...f_{X_p}(x_p)
$$

Ou seja, se as variáveis são independentes, então a distribuição conjunta é o produto das marginais.

**Lema** Analogamente ao caso discreto, as variáveis $X$ e $Y$ com função de distribuição $F_{X,Y}(x,y)$ são independentes se, e somente se

$$
F_{X,Y}(x,y) = F_{X}(x)F_{Y}(y)
$$

**Prova** Ver Seção 6.3 de @magalhaes2006probabilidade.

$\square$

### Distribuições Condicionais

**Definição** A distribuição condicional de $Y$ dado $X$ associa a cada valor $x$ de $X$ uma distribuição de probabilidade sobre os valores de $Y$, da seguinte maneira:

$$
f_{Y|X}(y|x) = \frac{f_{X,Y}(x,y)}{f_X(x)}
$$

Note que isso se refere à distribuição condicional de $Y$ dado $X$, estamos nos referindo ao conjunto de *todas as distribuições condicionais* associadas a cada um dos valores de $X$.
