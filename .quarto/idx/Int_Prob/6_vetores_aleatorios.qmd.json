{"title":"Vetores Aleatórios","markdown":{"yaml":{"title":"Vetores Aleatórios","lang":"pt","toc":true,"toc-title":"Nesta página","toc-location":"right","execute":{"warning":false,"message":false},"format":{"html":{"code-fold":true,"code-summary":"Mostrar Código"}}},"headingText":"Introdução","containsRefs":false,"markdown":"\n\n\n**Definição** (@rolla2021intprob) Um *vetor aleatório* $(X_1, ..., X_p)$ é uma função $X: \\Omega \\rightarrow \\mathbb{R}^p$ tal que cada coordenada $X_i$ é uma variável aleatória.\n\nImportante destacar que a notação para vetor aleatório pode variar de acordo com o autor. Podemos encontrar a notação como $\\textbf{X}$ (isto é, em negrito conforme @magalhaes2006probabilidade), $\\overset{\\sim}{X}$ ou, ainda, $\\underset{\\sim}{X}$ (@barryjames2023).\n\n<!-- função utilde do latex não disponível sem um usepackage(undertilde), por isso optei pelo overset com \\sim  -->\n\n## Vetores Aleatórios Discretos\n\n### Distribuições de Probabilidade\n\n**Definição** A distribuição de probabilidade do vetor aleatório $\\textbf{X} = (X_1, X_2, ..., X_p)$ é uma tabela que associa a cada valor $(x_1, x_2, ..., x_p)$ desse vetor sua correspondente probabilidade $P([X_1 = x_1, X_2 = x_2, ..., X_p = x_p])$. Ela é denominada também distribuição conjunta de $X_1, X_2, ..., X_p$.\n\nObservemos que a notação $[X_1 = x_1, X_2 = x_2, ..., X_p = x_p]$ representa a intersecção dos eventos $[X_1 = x_1], [X_2 = x_2], ..., [X_p = x_p]$ ou seja,\n\n$$\n\\begin{align*}\n[X_1 = x_1, X_2 = x_2, ..., X_p = x_p] &= \\{ \\omega: X_1(\\omega) = x_1, X_2(\\omega) = x_2, ..., X_p(\\omega) = x_p \\} = \\\\ &= \\{ \\omega: X_1(\\omega) = x_1 \\} \\cap \\{ \\omega: X_2(\\omega) = x_2 \\} \\cap ...  \\cap \\{ \\omega: X_p(\\omega) = x_p \\}\n\\end{align*}\n$$\n\nUma notação alternativa para $P([X_1 = x_1, X_2 = x_2, ..., X_p = x_p])$ é $P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)$.\n\n**Exemplo** Lançamento de dois dados honestos. Seja $X_1$ o valor da face do primeiro dado e $X_2$ o valor da face do segundo dado a distribuição conjunta do vetor aleatório $(X_1, X_2)$ é dada por\n\n![Distribuição Conjunta de Dois Dados Honestos](figs/tabela_dados.png)\n\n**Exemplo** Lançamento de um dado e uma moeda, ambos honestos. Seja $X$ o valor da face do primeiro dado e $Y$ a variável aleatória da moeda sendo $Y = 1$ se \"cara\" e $Y = 0$ se \"coroa\". Então, a distribuição conjunta do vetor aleatório $(X, Y)$ é dada por\n\n![Distribuição Conjunta de Um Dado e Uma Moeda Honestos](figs/tabela_dado_moeda.png)\n\n**Definição** (@dantas2013probabilidade) A função de distribuição do par de variáveis aleatórias discretas $(X,Y)$ é dada por:\n\n$$\nF(x,y) = P(X \\le x, Y \\le y) = \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i, Y = y_i)\n$$\n\nUma notação alternativa para $F(x,y)$ é $F_{X,Y}(x,y)$.\n\n### Distribuições Marginais\n\nA distribuição marginal de uma variável aleatória específica é dada ao somarmos as probabilidades \"varrendo\" todo o intervalo de todas as demais variáveis do vetor aleatório. Por exemplo, assuma que em um vetor aleatório $(X,Y)$, $X$ assume os valores $x_1, x_2, ..., x_n$ enquanto $Y$ assume os valores $y_1, y_2, ..., y_m$. Então, a ditribuição marginal de X é dada por\n\n$$\nP(X = x_i) = \\sum_{j = 1}^{m} = P(X = x_i, Y = y_j).\n$$\n\nAnalogamente, a dstribuição marginal de $Y$ é obtida através de\n\n$$\nP(Y = y_j) = \\sum_{i = 1}^{n} = P(X = x_i, Y = y_j).\n$$\n\nAbaixo, destacado em vermelho seguem as distribuições marginais do exemplo anterior:\n\n![Distribuição Conjunta de Um Dado e Uma Moeda Honestos com distribuições marginais](figs/tabela_dado_moeda_marginal.png)\n\nPara o caso multidimensional (ou seja, $p$-dimensional), o procedimento é análogo.\n\nSeja $\\textbf{X} = (X_1, X_2, ..., X_p)$ um vetor aleatório com distribuição conjunta dada por: $P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)$, onde $x_1, x_2, ..., x_p$, percorrem o conjunto de valores de $X_1, X_2, ..., X_p$, respectivamente.\n\nA distribuição marginal de $X_1$ é obtida calculando-se, para cada valor $x_1$ de $X_1$:\n\n$$\nP(X_1 = x_1) = \\sum_{x_2} \\dots \\sum_{x_p} P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)\n$$\n\nAnalogamente, para obter a marginal de qualquer subconjunto de $(X_1, X_2, ..., X_p)$, fazemos o somatório percorrendo o subconjunto complementar. Por exemplo, para a marginal de $(X_1, X_2)$, tem-se:\n\n$$\nP(X_1 = x_1, X_2 = x_2) = \\sum_{x_3} \\sum_{x_4} \\dots \\sum_{x_p} P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)\n$$\n\n### Vetores Aleatórios Independentes\n\n**Definição** As variáveis aleatórias $X_1, X_2, ..., X_p$ são ditas independentes se para todos os elementos $x_1, x_2, ..., x_p$ das mesmas tivermos:\n\n$$\nP(X_1 = x_1, X_2 = x_2, ..., X_p = x_p) = P(X_1 = x_1)P(X_2 = x_2)...P(X_p = x_p).\n$$\n\nOu seja, se as variáveis são independentes, então a distribuição conjunta é o produto das marginais.\n\n**Lema** As variáveis $X$ e $Y$ com função de distribuição $F_{X,Y}(x,y)$ são independentes se, e somente se\n\n$$\nF_{X,Y}(x,y) = F_{X}(x)F_{Y}(y)\n$$\n\n**Prova**\n\nIda:\n\n$$\n\\begin{align*}\nF_{X,Y}(x,y) &= \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i, Y = y_i) \\overset{\\text{Definição de Indep.}}{=} \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i)P(Y = y_i) \\overset{\\text{Separa Somatórios}}{=} \\\\ &= \\underbrace{\\sum_{i: x_i \\le x}P(X = x_i)}_{F_{X}(x)}  \\underbrace{\\sum_{j: y_j \\le j}P(Y = y_i)}_{F_{Y}(y)} = F_X(x)F_Y(y)\n\\end{align*}\n$$\n\nVolta:\n\n$$\n\\begin{align*}\nF_X(x)F_Y(y) &= \\sum_{i: x_i \\le x}P(X = x_i) \\sum_{j: y_j \\le j}P(Y = y_i) \\overset{\\text{Combina Somatórios}}{=} \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i)P(Y = y_i) \\overset{\\text{Definição de Indep.}}{=} \\\\ &= \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i, Y = y_i) = F_{X,Y}(x,y)\n\\end{align*}\n$$\n\n$\\square$\n\n### Distribuições Condicionais\n\n**Definição** A distribuição condicional de $Y$ dado $X$ associa a cada valor $x$ de $X$ uma distribuição de probabilidade sobre os valores de $Y$, da seguinte maneira:\n\n$$\nP(Y = x | X = x) = \\frac{P(X = x, Y = y)}{P(X = x)}\n$$\n\nNote que isso se refere à distribuição condicional de $Y$ dado $X$, estamos nos referindo ao conjunto de *todas as distribuições condicionais* associadas a cada um dos valores de $X$.\n\n## Vetores Aleatórios Contínuos\n\n### Distribuições de Probabilidade\n\n**Definição** Uma função $f(x,y)$ definida para $- \\infty < x < + \\infty$, $- \\infty < y < + \\infty$, não-negativa e satisfazendo a condição\n\n$$\n\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}f(x,y)dxdy=1\n$$\n\né denominada uma função densidade de probabilidade da variável aleatória bidimensional $(X,Y)$ se para todo o subconjunto $B$ de pontos do $\\mathbb{R}^2$ tivermos:\n\n$$\nP((X,Y) \\in B) = \\int\\int_{B}f(x,y)dxdy\n$$\n\nSegundo @dantas2013probabilidade, a interpretação da função densidade de probabilidade no caso bidimensional é a seguinte: seja $(x,y)$ um ponto do plano e consideremos um retângulo de lados $\\Delta x$ e $\\Delta y$ construído a partir do ponto $(x,y)$. A probabilidade de que $(X,Y)$ pertença a esse retângulo é aproximadamente igual ao volume do paralelepípedo de lados $\\Delta x$ e $\\Delta y$ e cuja altura é $f(x,y)$, ou seja,\n\n![Construção de probabilidade de uma distribuição conjunta bidimensional (Extraído de @dantas2013probabilidade)](figs/bidimensional_deltas.png){width=\"50%\"}\n\nAbaixo, seguem alguns exemplos visuais tridimensionais:\n\n**Exemplo** Função bidimensional com área destacada *entre dois valores de cada variável*:\n\nSuponha a densidade\n\n$$\nf(x,y) = 9x^2y^2, \\quad 0 \\le x,y \\le 1,\n$$\n\nSuponha o cálculo de probabilidade do tipo:\n\n$$\nP(c \\le X \\le d, \\; e \\le Y \\le f) \\;=\\; \n\\int_c^d \\int_e^f 9x^2 y^2 \\, dy \\, dx.\n$$\n\nEssa integral tem solução fechada:\n\n$$\nP = (d^3 - c^3)\\,(f^3 - e^3).\n$$\n\nVamos calcular e ilustrar o valor da probabilidade $P(0.2 \\le X \\le 0.6, 0.3 \\le Y \\le 0.8)$:\n\n```{r}\n# Distribuição montanhosa f(x,y) = 9x^2 y^2\nif (!requireNamespace(\"plotly\", quietly = TRUE)) install.packages(\"plotly\")\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) install.packages(\"ggplot2\")\n\nlibrary(plotly)\nlibrary(ggplot2)\n\n# --- Intervalos ---\nc1 <- 0.2; d1 <- 0.6   # intervalo para X\ne1 <- 0.3; f1 <- 0.8   # intervalo para Y\n\n# Função densidade\nf_xy <- function(x, y) 9 * x^2 * y^2\n\n# Probabilidade analítica\nprob_interval <- (d1^3 - c1^3) * (f1^3 - e1^3)\ncat(sprintf(\"Probabilidade P(%.2f <= X <= %.2f, %.2f <= Y <= %.2f) = %.4f\\n\",\n            c1, d1, e1, f1, prob_interval))\n\n```\n\n```{r}\n# --- Grid para visualização ---\nx_seq <- seq(0, 1, length.out = 80)\ny_seq <- seq(0, 1, length.out = 80)\nZ <- outer(x_seq, y_seq, f_xy)\n\n# Máscara região do intervalo\nmask_region <- outer(x_seq, y_seq, function(x, y) (x >= c1 & x <= d1 & y >= e1 & y <= f1))\n\n# --- Gráfico 3D ---\np3d <- plot_ly(showscale = FALSE) %>%\n  add_surface(x = x_seq, y = y_seq, z = Z,\n              opacity = 0.6, name = \"densidade\") %>%\n  add_surface(x = x_seq, y = y_seq,\n              z = ifelse(mask_region, Z, NA),\n              opacity = 1.0, name = \"região do intervalo\") %>%\n  layout(title = \"Distribuição f(x,y) = 9x²y² com intervalo destacado\",\n         scene = list(xaxis = list(title = \"X\"),\n                      yaxis = list(title = \"Y\"),\n                      zaxis = list(title = \"densidade\")))\n\np3d\n```\n\n**Exemplo** Normal Bivariada\n\n```{r}\n# --- Dependências (instalar se não estiverem disponíveis) ---\npacotes <- c(\"mvtnorm\", \"plotly\")\nnao_instalados <- pacotes[!pacotes %in% installed.packages()[, \"Package\"]]\nif(length(nao_instalados)) install.packages(nao_instalados, repos = \"https://cloud.r-project.org\")\n\nlibrary(mvtnorm)  # para dmvnorm\nlibrary(plotly)   # para superfície 3D interativa\n\n# --- Parâmetros da normal bivariada ---\nmu <- c(0, 0)                         # vetor de médias\nSigma <- matrix(c(1.0, 0.6,           # matriz de covariância com correlação\n                  0.6, 1.0), ncol=2)\n\n# --- Grade onde avaliamos a densidade ---\nx_seq <- seq(-3, 3, length.out = 121)\ny_seq <- seq(-3, 3, length.out = 121)\ngrade <- expand.grid(x = x_seq, y = y_seq)\n\n# Avaliar densidade bivariada na grade\ndens <- dmvnorm(grade, mean = mu, sigma = Sigma)\nz_mat <- matrix(dens, nrow = length(x_seq), ncol = length(y_seq))\n\n# --- Superfície 3D interativa com plotly ---\np <- plot_ly(x = x_seq, y = y_seq, z = ~z_mat, showscale = TRUE) %>%\n  add_surface() %>%\n  layout(title = \"Densidade Normal Bivariada (interativa)\",\n         scene = list(\n           xaxis = list(title = \"X1\"),\n           yaxis = list(title = \"X2\"),\n           zaxis = list(title = \"Densidade\")\n         ))\n# Aparece no Viewer do RStudio ou no navegador\np\n```\n\n**Definição** (@dantas2013probabilidade) A função de distribuição de uma variável aleatória bidimensional $(X,Y)$ é dada por:\n\n$$\nF(x,y) = P(X \\le x, Y \\le y), \\quad x \\in \\mathbb{R}, y \\in \\mathbb{R}\n$$\n\nUma notação alternativa para $F(x,y)$ é $F_{X,Y}(x,y)$.\n\nNo caso de variáveis aleatórias contínuas $X$ e $Y$, a probabilidade do evento $[X \\le x, Y \\le, y]$ é igual ao valor da integral da densidade conjunta de $(X, Y)$ no conjunto $B = [X \\le x, Y \\le, y]$\n\n$$\nF(x,y) = \\int_{-\\infty}^{x}\\int_{-\\infty}^{y} f(u,v) dudv\n$$\n\nOu com uma notação alternativa:\n\n$$\nF_{X,Y}(x,y) = \\int_{-\\infty}^{x}\\int_{-\\infty}^{y} f_{X,Y}(u,v) dudv\n$$\n\n### Distribuições Marginais\n\nDada a densidade conjunta das variáveis $X$ e $Y$, podemos determinar as densidades de $X$ e de $Y$ isoladamente. Essas densidades são chamadas de densidades marginais $f_X(x)$ e $f_Y(x)$, respectivamente. Elas são obtidas através da seguinte maneira:\n\n$$\n\\begin{align*}\nf_X(x) = \\int_{-\\infty}^{+\\infty} f(x,y) dy \\\\\nf_Y(y) = \\int_{-\\infty}^{+\\infty} f(x,y) dx\n\\end{align*}\n$$\n\nPara o caso multivariado, por exemplo para o vetor aleatório $(X_1, X_2, ..., X_p)$ para obter uma marginal em específico, por exemplo, $X_1$ integramos em relação à todas às demais, isto é:\n\n$$\nf_{X_1}(x_1) = \\overbrace{\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty} ... \\int_{-\\infty}^{+\\infty}}^{\\text{p-1 integrais}} f(x_1, x_2, ..., x_p) dx_2dx_3...dx_p\n$$\n\n\n### Vetores Aleatórios Independentes\n\n**Definição** As variáveis aleatórias $X$ e $Y$, cuja densidade conjunta é $f(x,y)$, para $x,y \\in \\mathbb{R}$, e cujas densidades marginais são denotadas $f_X(x)$ e $f_Y(y)$, são ditas independentes se para todo o par de valores $(x,y)$ tivermos\n\n$$\nf(x,y) = f_X(x)f_Y(y)\n$$\n\nE no caso $p$-dimensional:\n\n$$\nf_{\\textbf{X}}(x_1,x_2, ..., x_p) = f_{X_1}(x_1)f_{X_2}(x_2)...f_{X_p}(x_p)\n$$\n\nOu seja, se as variáveis são independentes, então a distribuição conjunta é o produto das marginais.\n\n**Lema** Analogamente ao caso discreto, as variáveis $X$ e $Y$ com função de distribuição $F_{X,Y}(x,y)$ são independentes se, e somente se\n\n$$\nF_{X,Y}(x,y) = F_{X}(x)F_{Y}(y)\n$$\n\n**Prova** Ver Seção 6.3 de @magalhaes2006probabilidade.\n\n$\\square$\n\n### Distribuições Condicionais\n\n**Definição** A distribuição condicional de $Y$ dado $X$ associa a cada valor $x$ de $X$ uma distribuição de probabilidade sobre os valores de $Y$, da seguinte maneira:\n\n$$\nf_{Y|X}(y|x) = \\frac{f_{X,Y}(x,y)}{f_X(x)}\n$$\n\nNote que isso se refere à distribuição condicional de $Y$ dado $X$, estamos nos referindo ao conjunto de *todas as distribuições condicionais* associadas a cada um dos valores de $X$.\n","srcMarkdownNoYaml":"\n\n# Introdução\n\n**Definição** (@rolla2021intprob) Um *vetor aleatório* $(X_1, ..., X_p)$ é uma função $X: \\Omega \\rightarrow \\mathbb{R}^p$ tal que cada coordenada $X_i$ é uma variável aleatória.\n\nImportante destacar que a notação para vetor aleatório pode variar de acordo com o autor. Podemos encontrar a notação como $\\textbf{X}$ (isto é, em negrito conforme @magalhaes2006probabilidade), $\\overset{\\sim}{X}$ ou, ainda, $\\underset{\\sim}{X}$ (@barryjames2023).\n\n<!-- função utilde do latex não disponível sem um usepackage(undertilde), por isso optei pelo overset com \\sim  -->\n\n## Vetores Aleatórios Discretos\n\n### Distribuições de Probabilidade\n\n**Definição** A distribuição de probabilidade do vetor aleatório $\\textbf{X} = (X_1, X_2, ..., X_p)$ é uma tabela que associa a cada valor $(x_1, x_2, ..., x_p)$ desse vetor sua correspondente probabilidade $P([X_1 = x_1, X_2 = x_2, ..., X_p = x_p])$. Ela é denominada também distribuição conjunta de $X_1, X_2, ..., X_p$.\n\nObservemos que a notação $[X_1 = x_1, X_2 = x_2, ..., X_p = x_p]$ representa a intersecção dos eventos $[X_1 = x_1], [X_2 = x_2], ..., [X_p = x_p]$ ou seja,\n\n$$\n\\begin{align*}\n[X_1 = x_1, X_2 = x_2, ..., X_p = x_p] &= \\{ \\omega: X_1(\\omega) = x_1, X_2(\\omega) = x_2, ..., X_p(\\omega) = x_p \\} = \\\\ &= \\{ \\omega: X_1(\\omega) = x_1 \\} \\cap \\{ \\omega: X_2(\\omega) = x_2 \\} \\cap ...  \\cap \\{ \\omega: X_p(\\omega) = x_p \\}\n\\end{align*}\n$$\n\nUma notação alternativa para $P([X_1 = x_1, X_2 = x_2, ..., X_p = x_p])$ é $P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)$.\n\n**Exemplo** Lançamento de dois dados honestos. Seja $X_1$ o valor da face do primeiro dado e $X_2$ o valor da face do segundo dado a distribuição conjunta do vetor aleatório $(X_1, X_2)$ é dada por\n\n![Distribuição Conjunta de Dois Dados Honestos](figs/tabela_dados.png)\n\n**Exemplo** Lançamento de um dado e uma moeda, ambos honestos. Seja $X$ o valor da face do primeiro dado e $Y$ a variável aleatória da moeda sendo $Y = 1$ se \"cara\" e $Y = 0$ se \"coroa\". Então, a distribuição conjunta do vetor aleatório $(X, Y)$ é dada por\n\n![Distribuição Conjunta de Um Dado e Uma Moeda Honestos](figs/tabela_dado_moeda.png)\n\n**Definição** (@dantas2013probabilidade) A função de distribuição do par de variáveis aleatórias discretas $(X,Y)$ é dada por:\n\n$$\nF(x,y) = P(X \\le x, Y \\le y) = \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i, Y = y_i)\n$$\n\nUma notação alternativa para $F(x,y)$ é $F_{X,Y}(x,y)$.\n\n### Distribuições Marginais\n\nA distribuição marginal de uma variável aleatória específica é dada ao somarmos as probabilidades \"varrendo\" todo o intervalo de todas as demais variáveis do vetor aleatório. Por exemplo, assuma que em um vetor aleatório $(X,Y)$, $X$ assume os valores $x_1, x_2, ..., x_n$ enquanto $Y$ assume os valores $y_1, y_2, ..., y_m$. Então, a ditribuição marginal de X é dada por\n\n$$\nP(X = x_i) = \\sum_{j = 1}^{m} = P(X = x_i, Y = y_j).\n$$\n\nAnalogamente, a dstribuição marginal de $Y$ é obtida através de\n\n$$\nP(Y = y_j) = \\sum_{i = 1}^{n} = P(X = x_i, Y = y_j).\n$$\n\nAbaixo, destacado em vermelho seguem as distribuições marginais do exemplo anterior:\n\n![Distribuição Conjunta de Um Dado e Uma Moeda Honestos com distribuições marginais](figs/tabela_dado_moeda_marginal.png)\n\nPara o caso multidimensional (ou seja, $p$-dimensional), o procedimento é análogo.\n\nSeja $\\textbf{X} = (X_1, X_2, ..., X_p)$ um vetor aleatório com distribuição conjunta dada por: $P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)$, onde $x_1, x_2, ..., x_p$, percorrem o conjunto de valores de $X_1, X_2, ..., X_p$, respectivamente.\n\nA distribuição marginal de $X_1$ é obtida calculando-se, para cada valor $x_1$ de $X_1$:\n\n$$\nP(X_1 = x_1) = \\sum_{x_2} \\dots \\sum_{x_p} P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)\n$$\n\nAnalogamente, para obter a marginal de qualquer subconjunto de $(X_1, X_2, ..., X_p)$, fazemos o somatório percorrendo o subconjunto complementar. Por exemplo, para a marginal de $(X_1, X_2)$, tem-se:\n\n$$\nP(X_1 = x_1, X_2 = x_2) = \\sum_{x_3} \\sum_{x_4} \\dots \\sum_{x_p} P(X_1 = x_1, X_2 = x_2, ..., X_p = x_p)\n$$\n\n### Vetores Aleatórios Independentes\n\n**Definição** As variáveis aleatórias $X_1, X_2, ..., X_p$ são ditas independentes se para todos os elementos $x_1, x_2, ..., x_p$ das mesmas tivermos:\n\n$$\nP(X_1 = x_1, X_2 = x_2, ..., X_p = x_p) = P(X_1 = x_1)P(X_2 = x_2)...P(X_p = x_p).\n$$\n\nOu seja, se as variáveis são independentes, então a distribuição conjunta é o produto das marginais.\n\n**Lema** As variáveis $X$ e $Y$ com função de distribuição $F_{X,Y}(x,y)$ são independentes se, e somente se\n\n$$\nF_{X,Y}(x,y) = F_{X}(x)F_{Y}(y)\n$$\n\n**Prova**\n\nIda:\n\n$$\n\\begin{align*}\nF_{X,Y}(x,y) &= \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i, Y = y_i) \\overset{\\text{Definição de Indep.}}{=} \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i)P(Y = y_i) \\overset{\\text{Separa Somatórios}}{=} \\\\ &= \\underbrace{\\sum_{i: x_i \\le x}P(X = x_i)}_{F_{X}(x)}  \\underbrace{\\sum_{j: y_j \\le j}P(Y = y_i)}_{F_{Y}(y)} = F_X(x)F_Y(y)\n\\end{align*}\n$$\n\nVolta:\n\n$$\n\\begin{align*}\nF_X(x)F_Y(y) &= \\sum_{i: x_i \\le x}P(X = x_i) \\sum_{j: y_j \\le j}P(Y = y_i) \\overset{\\text{Combina Somatórios}}{=} \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i)P(Y = y_i) \\overset{\\text{Definição de Indep.}}{=} \\\\ &= \\sum_{i: x_i \\le x}\\sum_{j: y_j \\le j} P(X = x_i, Y = y_i) = F_{X,Y}(x,y)\n\\end{align*}\n$$\n\n$\\square$\n\n### Distribuições Condicionais\n\n**Definição** A distribuição condicional de $Y$ dado $X$ associa a cada valor $x$ de $X$ uma distribuição de probabilidade sobre os valores de $Y$, da seguinte maneira:\n\n$$\nP(Y = x | X = x) = \\frac{P(X = x, Y = y)}{P(X = x)}\n$$\n\nNote que isso se refere à distribuição condicional de $Y$ dado $X$, estamos nos referindo ao conjunto de *todas as distribuições condicionais* associadas a cada um dos valores de $X$.\n\n## Vetores Aleatórios Contínuos\n\n### Distribuições de Probabilidade\n\n**Definição** Uma função $f(x,y)$ definida para $- \\infty < x < + \\infty$, $- \\infty < y < + \\infty$, não-negativa e satisfazendo a condição\n\n$$\n\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty}f(x,y)dxdy=1\n$$\n\né denominada uma função densidade de probabilidade da variável aleatória bidimensional $(X,Y)$ se para todo o subconjunto $B$ de pontos do $\\mathbb{R}^2$ tivermos:\n\n$$\nP((X,Y) \\in B) = \\int\\int_{B}f(x,y)dxdy\n$$\n\nSegundo @dantas2013probabilidade, a interpretação da função densidade de probabilidade no caso bidimensional é a seguinte: seja $(x,y)$ um ponto do plano e consideremos um retângulo de lados $\\Delta x$ e $\\Delta y$ construído a partir do ponto $(x,y)$. A probabilidade de que $(X,Y)$ pertença a esse retângulo é aproximadamente igual ao volume do paralelepípedo de lados $\\Delta x$ e $\\Delta y$ e cuja altura é $f(x,y)$, ou seja,\n\n![Construção de probabilidade de uma distribuição conjunta bidimensional (Extraído de @dantas2013probabilidade)](figs/bidimensional_deltas.png){width=\"50%\"}\n\nAbaixo, seguem alguns exemplos visuais tridimensionais:\n\n**Exemplo** Função bidimensional com área destacada *entre dois valores de cada variável*:\n\nSuponha a densidade\n\n$$\nf(x,y) = 9x^2y^2, \\quad 0 \\le x,y \\le 1,\n$$\n\nSuponha o cálculo de probabilidade do tipo:\n\n$$\nP(c \\le X \\le d, \\; e \\le Y \\le f) \\;=\\; \n\\int_c^d \\int_e^f 9x^2 y^2 \\, dy \\, dx.\n$$\n\nEssa integral tem solução fechada:\n\n$$\nP = (d^3 - c^3)\\,(f^3 - e^3).\n$$\n\nVamos calcular e ilustrar o valor da probabilidade $P(0.2 \\le X \\le 0.6, 0.3 \\le Y \\le 0.8)$:\n\n```{r}\n# Distribuição montanhosa f(x,y) = 9x^2 y^2\nif (!requireNamespace(\"plotly\", quietly = TRUE)) install.packages(\"plotly\")\nif (!requireNamespace(\"ggplot2\", quietly = TRUE)) install.packages(\"ggplot2\")\n\nlibrary(plotly)\nlibrary(ggplot2)\n\n# --- Intervalos ---\nc1 <- 0.2; d1 <- 0.6   # intervalo para X\ne1 <- 0.3; f1 <- 0.8   # intervalo para Y\n\n# Função densidade\nf_xy <- function(x, y) 9 * x^2 * y^2\n\n# Probabilidade analítica\nprob_interval <- (d1^3 - c1^3) * (f1^3 - e1^3)\ncat(sprintf(\"Probabilidade P(%.2f <= X <= %.2f, %.2f <= Y <= %.2f) = %.4f\\n\",\n            c1, d1, e1, f1, prob_interval))\n\n```\n\n```{r}\n# --- Grid para visualização ---\nx_seq <- seq(0, 1, length.out = 80)\ny_seq <- seq(0, 1, length.out = 80)\nZ <- outer(x_seq, y_seq, f_xy)\n\n# Máscara região do intervalo\nmask_region <- outer(x_seq, y_seq, function(x, y) (x >= c1 & x <= d1 & y >= e1 & y <= f1))\n\n# --- Gráfico 3D ---\np3d <- plot_ly(showscale = FALSE) %>%\n  add_surface(x = x_seq, y = y_seq, z = Z,\n              opacity = 0.6, name = \"densidade\") %>%\n  add_surface(x = x_seq, y = y_seq,\n              z = ifelse(mask_region, Z, NA),\n              opacity = 1.0, name = \"região do intervalo\") %>%\n  layout(title = \"Distribuição f(x,y) = 9x²y² com intervalo destacado\",\n         scene = list(xaxis = list(title = \"X\"),\n                      yaxis = list(title = \"Y\"),\n                      zaxis = list(title = \"densidade\")))\n\np3d\n```\n\n**Exemplo** Normal Bivariada\n\n```{r}\n# --- Dependências (instalar se não estiverem disponíveis) ---\npacotes <- c(\"mvtnorm\", \"plotly\")\nnao_instalados <- pacotes[!pacotes %in% installed.packages()[, \"Package\"]]\nif(length(nao_instalados)) install.packages(nao_instalados, repos = \"https://cloud.r-project.org\")\n\nlibrary(mvtnorm)  # para dmvnorm\nlibrary(plotly)   # para superfície 3D interativa\n\n# --- Parâmetros da normal bivariada ---\nmu <- c(0, 0)                         # vetor de médias\nSigma <- matrix(c(1.0, 0.6,           # matriz de covariância com correlação\n                  0.6, 1.0), ncol=2)\n\n# --- Grade onde avaliamos a densidade ---\nx_seq <- seq(-3, 3, length.out = 121)\ny_seq <- seq(-3, 3, length.out = 121)\ngrade <- expand.grid(x = x_seq, y = y_seq)\n\n# Avaliar densidade bivariada na grade\ndens <- dmvnorm(grade, mean = mu, sigma = Sigma)\nz_mat <- matrix(dens, nrow = length(x_seq), ncol = length(y_seq))\n\n# --- Superfície 3D interativa com plotly ---\np <- plot_ly(x = x_seq, y = y_seq, z = ~z_mat, showscale = TRUE) %>%\n  add_surface() %>%\n  layout(title = \"Densidade Normal Bivariada (interativa)\",\n         scene = list(\n           xaxis = list(title = \"X1\"),\n           yaxis = list(title = \"X2\"),\n           zaxis = list(title = \"Densidade\")\n         ))\n# Aparece no Viewer do RStudio ou no navegador\np\n```\n\n**Definição** (@dantas2013probabilidade) A função de distribuição de uma variável aleatória bidimensional $(X,Y)$ é dada por:\n\n$$\nF(x,y) = P(X \\le x, Y \\le y), \\quad x \\in \\mathbb{R}, y \\in \\mathbb{R}\n$$\n\nUma notação alternativa para $F(x,y)$ é $F_{X,Y}(x,y)$.\n\nNo caso de variáveis aleatórias contínuas $X$ e $Y$, a probabilidade do evento $[X \\le x, Y \\le, y]$ é igual ao valor da integral da densidade conjunta de $(X, Y)$ no conjunto $B = [X \\le x, Y \\le, y]$\n\n$$\nF(x,y) = \\int_{-\\infty}^{x}\\int_{-\\infty}^{y} f(u,v) dudv\n$$\n\nOu com uma notação alternativa:\n\n$$\nF_{X,Y}(x,y) = \\int_{-\\infty}^{x}\\int_{-\\infty}^{y} f_{X,Y}(u,v) dudv\n$$\n\n### Distribuições Marginais\n\nDada a densidade conjunta das variáveis $X$ e $Y$, podemos determinar as densidades de $X$ e de $Y$ isoladamente. Essas densidades são chamadas de densidades marginais $f_X(x)$ e $f_Y(x)$, respectivamente. Elas são obtidas através da seguinte maneira:\n\n$$\n\\begin{align*}\nf_X(x) = \\int_{-\\infty}^{+\\infty} f(x,y) dy \\\\\nf_Y(y) = \\int_{-\\infty}^{+\\infty} f(x,y) dx\n\\end{align*}\n$$\n\nPara o caso multivariado, por exemplo para o vetor aleatório $(X_1, X_2, ..., X_p)$ para obter uma marginal em específico, por exemplo, $X_1$ integramos em relação à todas às demais, isto é:\n\n$$\nf_{X_1}(x_1) = \\overbrace{\\int_{-\\infty}^{+\\infty}\\int_{-\\infty}^{+\\infty} ... \\int_{-\\infty}^{+\\infty}}^{\\text{p-1 integrais}} f(x_1, x_2, ..., x_p) dx_2dx_3...dx_p\n$$\n\n\n### Vetores Aleatórios Independentes\n\n**Definição** As variáveis aleatórias $X$ e $Y$, cuja densidade conjunta é $f(x,y)$, para $x,y \\in \\mathbb{R}$, e cujas densidades marginais são denotadas $f_X(x)$ e $f_Y(y)$, são ditas independentes se para todo o par de valores $(x,y)$ tivermos\n\n$$\nf(x,y) = f_X(x)f_Y(y)\n$$\n\nE no caso $p$-dimensional:\n\n$$\nf_{\\textbf{X}}(x_1,x_2, ..., x_p) = f_{X_1}(x_1)f_{X_2}(x_2)...f_{X_p}(x_p)\n$$\n\nOu seja, se as variáveis são independentes, então a distribuição conjunta é o produto das marginais.\n\n**Lema** Analogamente ao caso discreto, as variáveis $X$ e $Y$ com função de distribuição $F_{X,Y}(x,y)$ são independentes se, e somente se\n\n$$\nF_{X,Y}(x,y) = F_{X}(x)F_{Y}(y)\n$$\n\n**Prova** Ver Seção 6.3 de @magalhaes2006probabilidade.\n\n$\\square$\n\n### Distribuições Condicionais\n\n**Definição** A distribuição condicional de $Y$ dado $X$ associa a cada valor $x$ de $X$ uma distribuição de probabilidade sobre os valores de $Y$, da seguinte maneira:\n\n$$\nf_{Y|X}(y|x) = \\frac{f_{X,Y}(x,y)}{f_X(x)}\n$$\n\nNote que isso se refere à distribuição condicional de $Y$ dado $X$, estamos nos referindo ao conjunto de *todas as distribuições condicionais* associadas a cada um dos valores de $X$.\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"6_vetores_aleatorios.html"},"language":{"toc-title-document":"Índice","toc-title-website":"Nesta página","related-formats-title":"Outros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fonte","other-links-title":"Outros Links","code-links-title":"Ligações de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Caderno do Artigo","notebook-preview-download":"Baixar Caderno","notebook-preview-download-src":"Descarregar código fonte","notebook-preview-back":"Voltar ao Artigo","manuscript-meca-bundle":"Arquivo MECA","section-title-abstract":"Resumo","section-title-appendices":"Apêndices","section-title-footnotes":"Notas de rodapé","section-title-references":"Referências","section-title-reuse":"Reuso","section-title-copyright":"Direito autoral","section-title-citation":"Citação","appendix-attribution-cite-as":"Por favor, cite este trabalho como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licença","title-block-author-single":"Autor","title-block-author-plural":"Autores","title-block-affiliation-single":"Afiliação","title-block-affiliation-plural":"Afiliações","title-block-published":"Data de Publicação","title-block-modified":"Data de Modificação","title-block-keywords":"Palavras-chave","callout-tip-title":"Dica","callout-note-title":"Nota","callout-warning-title":"Aviso","callout-important-title":"Importante","callout-caution-title":"Cuidado","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar o código","code-tools-hide-all-code":"Esconder o código","code-tools-view-source":"Ver o código fonte","code-tools-source-code":"Código fonte","tools-share":"Share","tools-download":"Download","code-line":"Linha","code-lines":"Linhas","copy-button-tooltip":"Copiar para a área de transferência","copy-button-tooltip-success":"Copiada","repo-action-links-edit":"Editar essa página","repo-action-links-source":"Ver o código fonte","repo-action-links-issue":"Criar uma issue","back-to-top":"De volta ao topo","search-no-results-text":"Nenhum resultado","search-matching-documents-text":"documentos correspondentes","search-copy-link-title":"Copiar link para a busca","search-hide-matches-text":"Esconder correspondências adicionais","search-more-match-text":"mais correspondência neste documento","search-more-matches-text":"mais correspondências neste documento","search-clear-button-title":"Limpar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Procurar","toggle-section":"Alternar seção","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo escuro","toggle-reader-mode":"Alternar modo de leitor","toggle-navigation":"Alternar de navegação","crossref-fig-title":"Figura","crossref-tbl-title":"Tabela","crossref-lst-title":"Listagem","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolário","crossref-prp-title":"Proposição","crossref-cnj-title":"Conjetura","crossref-def-title":"Definição","crossref-exm-title":"Exemplo","crossref-exr-title":"Exercício","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apêndice","crossref-sec-prefix":"Seção","crossref-eq-prefix":"Equação","crossref-lof-title":"Lista de Figuras","crossref-lot-title":"Lista de Tabelas","crossref-lol-title":"Lista de Listagens","environment-proof-title":"Comprovação","environment-remark-title":"Comentário","environment-solution-title":"Solução","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Pré-selecionado","listing-page-order-by-date-asc":"Mais velho","listing-page-order-by-date-desc":"O mais novo","listing-page-order-by-number-desc":"Decrescente","listing-page-order-by-number-asc":"Crescente","listing-page-field-date":"Data","listing-page-field-title":"Título","listing-page-field-description":"Descrição","listing-page-field-author":"Autor","listing-page-field-filename":"Nome do arquivo","listing-page-field-filemodified":"Arquivo modificado","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tempo de leitura","listing-page-field-wordcount":"Contagem de Palavras","listing-page-field-categories":"Categorias","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Tudo","listing-page-no-matches":"Nenhum item correspondente","listing-page-words":"{0} palavras","listing-page-filter":"Filtro","draft":"Rascunho"},"metadata":{"lang":"pt","fig-responsive":true,"quarto-version":"1.6.42","editor":"visual","bibliography":["../references.bib"],"theme":["cosmo"],"title":"Vetores Aleatórios","toc-title":"Nesta página","toc-location":"right","code-summary":"Mostrar Código"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}