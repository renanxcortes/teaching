{"title":"Lei dos Grandes Números","markdown":{"yaml":{"title":"Lei dos Grandes Números","lang":"pt","toc":true,"toc-title":"Nesta página","toc-location":"right","execute":{"warning":false,"message":false},"format":{"html":{"code-fold":true,"code-summary":"Mostrar Código"}}},"headingText":"Introdução e Condições Iniciais","containsRefs":false,"markdown":"\n\n\nA Lei dos Grandes Números (LGN) é um dos resultados mais famosos da Teoria da Probabilidade.\n\nSejam $X_1, X_2, ...$ variáveis aleatórias independentes e identicamente distribuídas ($iid$) com média e variância existentes e finitas, isto é $-\\infty < \\mu < +\\infty$ e $0 < \\sigma^2 < +\\infty$.\n\nAlém disso, defina $\\bar{X} = \\frac{\\sum_{i=1}^{n}{X_i}}{n}$ como sendo a média amostral.\n\n## Lei Forte dos Grandes Números\n\nA Lei Forte estabelece que a média amostral converge para $\\mu$ no infinito com probabilidade 1. Ou seja, $\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu$ com probabilidade 1.\n\nObserve que $\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu$ é um **evento**. Logo, a Lei Forte poderia ser reescrita com uma notação probabilística alternativa:\n\n$$P\\left(\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu \\right) = 1$$\n\nEste resultado estabelece que $\\bar{X}$ converge *quase certamente* para $\\mu$. Podemos interpretar esse resultado como sendo *à medida que n cresce, no infinito,* $\\bar{X}$ e $\\mu$ serão iguais. Ou seja, é uma convergência pontual do valor de uma variável aleatória (a média amostral) para uma constante (a média populacional).\n\nA prova deste teorema implica em provar que o evento acima é um evento de probabilidade 1, o que exige maior formalidade matemática fazendo uso do [Lema de Borel-Cantelli](https://pt.wikipedia.org/wiki/Lema_de_Borel-Cantelli).\n\n**Prova.** Ver Cáp. 5 de @barryjames2023.\n\n$\\square$\n\n## Lei Fraca dos Grandes Números\n\nA Lei Fraca estabelece que $\\forall \\varepsilon > 0$, então:\n\n$$P\\left(\\left| \\bar{X} - \\mu \\right| \\ge \\varepsilon \\right) \\xrightarrow{n \\rightarrow + \\infty} 0$$\n\nEste resultado estabelece que $\\bar{X}$ converge *em probabilidade* para $\\mu$.\n\n**Prova.** A prova faz uso da [Desigualdade de Chebyshev](https://pt.wikipedia.org/wiki/Desigualdade_de_Chebyshev):\n\n$$\n\\begin{align*}\nP\\left(\\left| \\bar{X} - \\mu \\right| \\ge \\varepsilon \\right) \\overset{\\text{Des. Cheb.}}{\\le} \\frac{Var(\\bar{X})}{\\varepsilon^2} = \\frac{Var\\left(\\frac{\\sum_{i=1}^{n}{X_i}}{n}\\right)}{\\varepsilon^2} \\overset{\\text{Prop. da Constante}}{=} \\frac{Var(\\sum_{i=1}^{n}{X_i})}{n^2\\varepsilon^2} \\overset{\\text{Indep.}}{=} \\\\ \n= \\frac{\\sum_{i=1}^{n}{Var(X_i)}}{n^2\\varepsilon^2} \\overset{\\text{Ident. Dist.}}{=} \\frac{n\\sigma^2}{n^2\\varepsilon^2} = \\frac{\\sigma^2}{n\\varepsilon^2} \\xrightarrow{n \\rightarrow + \\infty} 0\n\\end{align*}\n$$\n\n$\\square$\n\nEste resultado ilustra que $\\bar{X}$ converge *em probabilidade* para $\\mu$. Podemos interpretar esse resultado como sendo *à medida que n cresce, é extremamente improvável que a diferença entre* $\\bar{X}$ *e* $\\mu$ *seja maior que* $\\varepsilon$.\n\n## Relação entre Leis e Convergências\n\nÉ intuitivo pensar afirmarmos que duas quantidades são **iguais** é mais \"forte\" do que dizer que essas duas quantidades são \"altamente prováveis de **estarem próximas**\". Ora, se uma coisa é igual à outra, isso implica de que elas também são próximas. Tendo em vista que a Lei Forte dos Grandes Números representa a convergência *quase certa* e a Lei Fraca representa a convergência *em probabilidade*, temos que se\n\n$$Convergência\\ Quase\\ Certa \\implies Convergência\\ em\\ Probabilidade$$\n\nentão,\n\n$$Lei\\ Forte \\implies Lei\\ Fraca$$\n\nO contrário não vale para nenhuma das duas afirmativas acima.\n\n## Exemplo: O caso Bernoulli\n\nSuponha uma sequência independente de lançamentos de uma moeda honesta e a variável aleatória $X_i = 1$ se cara e $X_i = 0$ se coroa. Ou seja,\n\n$$X_i \\overset{iid}{\\sim}Bernoulli(p)$$\n\nonde $p = 0,5$. Então, pela Lei Forte dos Grandes Números:\n\n$$\\bar{X} = \\frac{\\sum_{i=1}^{n}{X_i}}{n} \\xrightarrow{n \\rightarrow + \\infty} p$$\n\nEste resultado mostra que a medida que ao jogarmos a moeda infinitas vezes, iremos convergir para um cenário em que metade dos lançamentos serão caras e metade serão coroas. Note que o resultado vale quando $n \\rightarrow + \\infty$, ou seja, ele não estabelece nada em uma quantidade finita de lançamentos onde pode existir variabilidade. Por exemplo, mesmo que seja altamente improvável que nos primeiros 100 lançamentos todos os resultados sejam a face \"Cara\", não existe nada matematicamente que estabeleça que isso seja impossível. No entanto, no limite do infinito as quantidades iniciais serão \"engolidas\" pela LGN. Para uma discussão mais aprofundada sobre esse tema recomenda-se uma leitura sobre o [Gambler's Fallacy](https://en.wikipedia.org/wiki/Gambler%27s_fallacy).\n\n## Exemplo Computacional\n\nNo R:\n\n```{r}\n# Carregar as bibliotecas necessárias\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Definir o número de lançamentos\nn <- 500\n\n# Simular lançamentos de uma moeda honesta\nset.seed(123) # Para reprodutibilidade\nlancamentos <- sample(c(\"Cara\", \"Coroa\"), n, replace = TRUE)\n\n# Calcular a proporção acumulada de caras\ndados <- data.frame(lancamentos) %>%\n  mutate(\n    n = row_number(),\n    proporcao_cara = cumsum(lancamentos == \"Cara\") / n\n  )\n\n# Criar o gráfico\nggplot(dados, aes(x = n, y = proporcao_cara)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Lei dos Grandes Números: Lançamento de uma Moeda Honesta\",\n       x = \"Número de Lançamentos\",\n       y = \"Proporção de Caras\") +\n  geom_hline(yintercept = 0.5, linetype = \"dashed\", color = \"red\") +\n  theme_minimal()\n\n```\n\nNo Python:\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Definindo o número de lançamentos\nn = 500\n\n# Simulando lançamentos de uma moeda honesta\nnp.random.seed(123)  # Para reprodutibilidade\nlancamentos = np.random.choice(['Cara', 'Coroa'], size=n)\n\n# Calculando a proporção acumulada de caras\nproporcao_cara = np.cumsum(lancamentos == 'Cara') / np.arange(1, n + 1)\n\n# Criando o gráfico\nplt.figure(figsize=(6, 4))\nplt.plot(proporcao_cara, color='blue', label='Proporção de Caras')\nplt.axhline(y=0.5, color='red', linestyle='--', label='Proporção Esperada (0.5)')\nplt.title('Lei dos Grandes Números: Lançamento de uma Moeda Honesta')\nplt.xlabel('Número de Lançamentos')\nplt.ylabel('Proporção de Caras')\nplt.legend()\nplt.grid()\nplt.show()\n```\n\n# Links Úteis\n\n[Aula de Harvard de Lei dos Grandes Números e Teorema Central do Limite](https://www.youtube.com/watch?v=OprNqnHsVIA&t=1910s)\n\n[Página da Wikipedia da Lei dos Grandes Números](https://en.wikipedia.org/wiki/Law_of_large_numbers)\n","srcMarkdownNoYaml":"\n\n# Introdução e Condições Iniciais\n\nA Lei dos Grandes Números (LGN) é um dos resultados mais famosos da Teoria da Probabilidade.\n\nSejam $X_1, X_2, ...$ variáveis aleatórias independentes e identicamente distribuídas ($iid$) com média e variância existentes e finitas, isto é $-\\infty < \\mu < +\\infty$ e $0 < \\sigma^2 < +\\infty$.\n\nAlém disso, defina $\\bar{X} = \\frac{\\sum_{i=1}^{n}{X_i}}{n}$ como sendo a média amostral.\n\n## Lei Forte dos Grandes Números\n\nA Lei Forte estabelece que a média amostral converge para $\\mu$ no infinito com probabilidade 1. Ou seja, $\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu$ com probabilidade 1.\n\nObserve que $\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu$ é um **evento**. Logo, a Lei Forte poderia ser reescrita com uma notação probabilística alternativa:\n\n$$P\\left(\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu \\right) = 1$$\n\nEste resultado estabelece que $\\bar{X}$ converge *quase certamente* para $\\mu$. Podemos interpretar esse resultado como sendo *à medida que n cresce, no infinito,* $\\bar{X}$ e $\\mu$ serão iguais. Ou seja, é uma convergência pontual do valor de uma variável aleatória (a média amostral) para uma constante (a média populacional).\n\nA prova deste teorema implica em provar que o evento acima é um evento de probabilidade 1, o que exige maior formalidade matemática fazendo uso do [Lema de Borel-Cantelli](https://pt.wikipedia.org/wiki/Lema_de_Borel-Cantelli).\n\n**Prova.** Ver Cáp. 5 de @barryjames2023.\n\n$\\square$\n\n## Lei Fraca dos Grandes Números\n\nA Lei Fraca estabelece que $\\forall \\varepsilon > 0$, então:\n\n$$P\\left(\\left| \\bar{X} - \\mu \\right| \\ge \\varepsilon \\right) \\xrightarrow{n \\rightarrow + \\infty} 0$$\n\nEste resultado estabelece que $\\bar{X}$ converge *em probabilidade* para $\\mu$.\n\n**Prova.** A prova faz uso da [Desigualdade de Chebyshev](https://pt.wikipedia.org/wiki/Desigualdade_de_Chebyshev):\n\n$$\n\\begin{align*}\nP\\left(\\left| \\bar{X} - \\mu \\right| \\ge \\varepsilon \\right) \\overset{\\text{Des. Cheb.}}{\\le} \\frac{Var(\\bar{X})}{\\varepsilon^2} = \\frac{Var\\left(\\frac{\\sum_{i=1}^{n}{X_i}}{n}\\right)}{\\varepsilon^2} \\overset{\\text{Prop. da Constante}}{=} \\frac{Var(\\sum_{i=1}^{n}{X_i})}{n^2\\varepsilon^2} \\overset{\\text{Indep.}}{=} \\\\ \n= \\frac{\\sum_{i=1}^{n}{Var(X_i)}}{n^2\\varepsilon^2} \\overset{\\text{Ident. Dist.}}{=} \\frac{n\\sigma^2}{n^2\\varepsilon^2} = \\frac{\\sigma^2}{n\\varepsilon^2} \\xrightarrow{n \\rightarrow + \\infty} 0\n\\end{align*}\n$$\n\n$\\square$\n\nEste resultado ilustra que $\\bar{X}$ converge *em probabilidade* para $\\mu$. Podemos interpretar esse resultado como sendo *à medida que n cresce, é extremamente improvável que a diferença entre* $\\bar{X}$ *e* $\\mu$ *seja maior que* $\\varepsilon$.\n\n## Relação entre Leis e Convergências\n\nÉ intuitivo pensar afirmarmos que duas quantidades são **iguais** é mais \"forte\" do que dizer que essas duas quantidades são \"altamente prováveis de **estarem próximas**\". Ora, se uma coisa é igual à outra, isso implica de que elas também são próximas. Tendo em vista que a Lei Forte dos Grandes Números representa a convergência *quase certa* e a Lei Fraca representa a convergência *em probabilidade*, temos que se\n\n$$Convergência\\ Quase\\ Certa \\implies Convergência\\ em\\ Probabilidade$$\n\nentão,\n\n$$Lei\\ Forte \\implies Lei\\ Fraca$$\n\nO contrário não vale para nenhuma das duas afirmativas acima.\n\n## Exemplo: O caso Bernoulli\n\nSuponha uma sequência independente de lançamentos de uma moeda honesta e a variável aleatória $X_i = 1$ se cara e $X_i = 0$ se coroa. Ou seja,\n\n$$X_i \\overset{iid}{\\sim}Bernoulli(p)$$\n\nonde $p = 0,5$. Então, pela Lei Forte dos Grandes Números:\n\n$$\\bar{X} = \\frac{\\sum_{i=1}^{n}{X_i}}{n} \\xrightarrow{n \\rightarrow + \\infty} p$$\n\nEste resultado mostra que a medida que ao jogarmos a moeda infinitas vezes, iremos convergir para um cenário em que metade dos lançamentos serão caras e metade serão coroas. Note que o resultado vale quando $n \\rightarrow + \\infty$, ou seja, ele não estabelece nada em uma quantidade finita de lançamentos onde pode existir variabilidade. Por exemplo, mesmo que seja altamente improvável que nos primeiros 100 lançamentos todos os resultados sejam a face \"Cara\", não existe nada matematicamente que estabeleça que isso seja impossível. No entanto, no limite do infinito as quantidades iniciais serão \"engolidas\" pela LGN. Para uma discussão mais aprofundada sobre esse tema recomenda-se uma leitura sobre o [Gambler's Fallacy](https://en.wikipedia.org/wiki/Gambler%27s_fallacy).\n\n## Exemplo Computacional\n\nNo R:\n\n```{r}\n# Carregar as bibliotecas necessárias\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Definir o número de lançamentos\nn <- 500\n\n# Simular lançamentos de uma moeda honesta\nset.seed(123) # Para reprodutibilidade\nlancamentos <- sample(c(\"Cara\", \"Coroa\"), n, replace = TRUE)\n\n# Calcular a proporção acumulada de caras\ndados <- data.frame(lancamentos) %>%\n  mutate(\n    n = row_number(),\n    proporcao_cara = cumsum(lancamentos == \"Cara\") / n\n  )\n\n# Criar o gráfico\nggplot(dados, aes(x = n, y = proporcao_cara)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Lei dos Grandes Números: Lançamento de uma Moeda Honesta\",\n       x = \"Número de Lançamentos\",\n       y = \"Proporção de Caras\") +\n  geom_hline(yintercept = 0.5, linetype = \"dashed\", color = \"red\") +\n  theme_minimal()\n\n```\n\nNo Python:\n\n```{python}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Definindo o número de lançamentos\nn = 500\n\n# Simulando lançamentos de uma moeda honesta\nnp.random.seed(123)  # Para reprodutibilidade\nlancamentos = np.random.choice(['Cara', 'Coroa'], size=n)\n\n# Calculando a proporção acumulada de caras\nproporcao_cara = np.cumsum(lancamentos == 'Cara') / np.arange(1, n + 1)\n\n# Criando o gráfico\nplt.figure(figsize=(6, 4))\nplt.plot(proporcao_cara, color='blue', label='Proporção de Caras')\nplt.axhline(y=0.5, color='red', linestyle='--', label='Proporção Esperada (0.5)')\nplt.title('Lei dos Grandes Números: Lançamento de uma Moeda Honesta')\nplt.xlabel('Número de Lançamentos')\nplt.ylabel('Proporção de Caras')\nplt.legend()\nplt.grid()\nplt.show()\n```\n\n# Links Úteis\n\n[Aula de Harvard de Lei dos Grandes Números e Teorema Central do Limite](https://www.youtube.com/watch?v=OprNqnHsVIA&t=1910s)\n\n[Página da Wikipedia da Lei dos Grandes Números](https://en.wikipedia.org/wiki/Law_of_large_numbers)\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":false,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"message":false,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":true,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../styles.css"],"toc":true,"output-file":"LGN.html"},"language":{"toc-title-document":"Índice","toc-title-website":"Nesta página","related-formats-title":"Outros formatos","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Fonte","other-links-title":"Outros Links","code-links-title":"Ligações de código","launch-dev-container-title":"Iniciar Dev Container","launch-binder-title":"Iniciar Binder","article-notebook-label":"Caderno do Artigo","notebook-preview-download":"Baixar Caderno","notebook-preview-download-src":"Descarregar código fonte","notebook-preview-back":"Voltar ao Artigo","manuscript-meca-bundle":"Arquivo MECA","section-title-abstract":"Resumo","section-title-appendices":"Apêndices","section-title-footnotes":"Notas de rodapé","section-title-references":"Referências","section-title-reuse":"Reuso","section-title-copyright":"Direito autoral","section-title-citation":"Citação","appendix-attribution-cite-as":"Por favor, cite este trabalho como:","appendix-attribution-bibtex":"BibTeX","appendix-view-license":"Ver Licença","title-block-author-single":"Autor","title-block-author-plural":"Autores","title-block-affiliation-single":"Afiliação","title-block-affiliation-plural":"Afiliações","title-block-published":"Data de Publicação","title-block-modified":"Data de Modificação","title-block-keywords":"Palavras-chave","callout-tip-title":"Dica","callout-note-title":"Nota","callout-warning-title":"Aviso","callout-important-title":"Importante","callout-caution-title":"Cuidado","code-summary":"Código","code-tools-menu-caption":"Código","code-tools-show-all-code":"Mostrar o código","code-tools-hide-all-code":"Esconder o código","code-tools-view-source":"Ver o código fonte","code-tools-source-code":"Código fonte","tools-share":"Share","tools-download":"Download","code-line":"Linha","code-lines":"Linhas","copy-button-tooltip":"Copiar para a área de transferência","copy-button-tooltip-success":"Copiada","repo-action-links-edit":"Editar essa página","repo-action-links-source":"Ver o código fonte","repo-action-links-issue":"Criar uma issue","back-to-top":"De volta ao topo","search-no-results-text":"Nenhum resultado","search-matching-documents-text":"documentos correspondentes","search-copy-link-title":"Copiar link para a busca","search-hide-matches-text":"Esconder correspondências adicionais","search-more-match-text":"mais correspondência neste documento","search-more-matches-text":"mais correspondências neste documento","search-clear-button-title":"Limpar","search-text-placeholder":"","search-detached-cancel-button-title":"Cancelar","search-submit-button-title":"Enviar","search-label":"Procurar","toggle-section":"Alternar seção","toggle-sidebar":"Alternar barra lateral","toggle-dark-mode":"Alternar modo escuro","toggle-reader-mode":"Alternar modo de leitor","toggle-navigation":"Alternar de navegação","crossref-fig-title":"Figura","crossref-tbl-title":"Tabela","crossref-lst-title":"Listagem","crossref-thm-title":"Teorema","crossref-lem-title":"Lema","crossref-cor-title":"Corolário","crossref-prp-title":"Proposição","crossref-cnj-title":"Conjetura","crossref-def-title":"Definição","crossref-exm-title":"Exemplo","crossref-exr-title":"Exercício","crossref-ch-prefix":"Capítulo","crossref-apx-prefix":"Apêndice","crossref-sec-prefix":"Seção","crossref-eq-prefix":"Equação","crossref-lof-title":"Lista de Figuras","crossref-lot-title":"Lista de Tabelas","crossref-lol-title":"Lista de Listagens","environment-proof-title":"Comprovação","environment-remark-title":"Comentário","environment-solution-title":"Solução","listing-page-order-by":"Ordenar por","listing-page-order-by-default":"Pré-selecionado","listing-page-order-by-date-asc":"Mais velho","listing-page-order-by-date-desc":"O mais novo","listing-page-order-by-number-desc":"Decrescente","listing-page-order-by-number-asc":"Crescente","listing-page-field-date":"Data","listing-page-field-title":"Título","listing-page-field-description":"Descrição","listing-page-field-author":"Autor","listing-page-field-filename":"Nome do arquivo","listing-page-field-filemodified":"Arquivo modificado","listing-page-field-subtitle":"Subtítulo","listing-page-field-readingtime":"Tempo de leitura","listing-page-field-wordcount":"Contagem de Palavras","listing-page-field-categories":"Categorias","listing-page-minutes-compact":"{0} minutos","listing-page-category-all":"Tudo","listing-page-no-matches":"Nenhum item correspondente","listing-page-words":"{0} palavras","listing-page-filter":"Filtro","draft":"Rascunho"},"metadata":{"lang":"pt","fig-responsive":true,"quarto-version":"1.8.25","editor":"visual","bibliography":["../references.bib"],"theme":["cosmo"],"title":"Lei dos Grandes Números","toc-title":"Nesta página","toc-location":"right","code-summary":"Mostrar Código"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}