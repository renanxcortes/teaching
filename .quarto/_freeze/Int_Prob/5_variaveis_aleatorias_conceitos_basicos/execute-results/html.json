{
  "hash": "dd5bbd6962340a3f3ce11ca1b311c6a5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Conceitos Básicos\"\nlang: pt # Equações ficarem referenciadas em Português\n\ntoc: true\ntoc-title: \"Nesta página\"\ntoc-location: right\n\nexecute: \n  warning: false\n  message: false\n\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Mostrar Código\"\n---\n\n\n\n\n# Introdução\n\nInformalmente, uma variável aleatória (V.A.) é um *valor numérico* do resultado de um experimento aleatório. Formalmente, abaixo segue a definição (@magalhaes2006probabilidade, @barryjames2023):\n\n**Definição** Seja $(\\Omega, \\mathcal{F}, \\mathcal{P})$ um espaço de probabilidade. Denominamos de *variável aleatória*, qualquer função $X : \\Omega \\rightarrow \\mathbb{R}$ tal que $[X \\le x]$ é evento aleatório para todo $x \\in \\mathbb{R}$; isto é, $[X \\le x] \\in \\mathcal{F}, \\forall x \\in \\mathbb{R}$[^1].\n\n[^1]: Esta definição formal matemática, na sua integridade, pode parece difícil de assimilar num primeiro momento. Em linhas gerais, uma variável aleatória deve ser uma função mensurável dentro da sua $\\sigma$-álgebra do espaço de probabildade. Por exemplo, é possível definir uma $\\sigma$-álgebra de maneira incoveniente e fazer com que algumas variáveis aleatórias não se encaixem como função mensurável por ter que depender de eventos aleatórios que não estejam presentes em $\\mathcal{F}$. Nesse sentido, o cojunto das partes e a [$\\sigma$-álgebra de Borel](https://pt.wikipedia.org/wiki/%C3%81lgebra_de_Borel) são as **preferidas**, justamente por permitirem que praticamente todas as variáveis de interesse sejam mensuráveis. Para maiores detalhes, ver o exemplo 2.1 de @magalhaes2006probabilidade e as observações da Seção 2.1 de @barryjames2023.\n\n**Exemplo** (@mood1974introduction) Assuma um experimento de lançar uma moeda honesta para cima. Defina a variável aleatória $X$ assumir o valor $1$ quando sair cara, e o valor $0$ quando sair coroa. Ou seja:\n\n$$\n\\begin{align*}\n\\Omega &= \\{cara, coroa\\} \\\\\nX &= \n\\begin{cases}\n  1, & \\text{ se $\\omega$ = \\{cara\\},} \\\\\n  0, & \\text{ se $\\omega$ = \\{coroa\\}}\n\\end{cases}\n\\end{align*}\n$$\n\nFormalmente, precisamos mostrar que esta construção deste experimento $X$ mostrando que $\\{\\omega: X(\\omega) \\le x\\}$ para todo $x \\in \\mathbb{R}$ pertence à $\\mathcal{F}$. Primeiramente, note que $\\mathcal{F}$ é composto por quatro elementos sendo $\\{\\emptyset, \\Omega, \\{cara\\},\\{coroa\\}\\}$. Agora, verificamos que se $x < 0$, $\\{\\omega: X(\\omega) \\le x\\} = \\emptyset$; e se $0 \\le x < 0$, $\\{\\omega: X(\\omega) \\le x\\} = \\{cara\\}$; e se $x \\ge 1$, $\\{\\omega: X(\\omega) \\le x\\} = \\Omega = \\{cara, coroa\\}$. Então, pra cada $x$ real o evento $\\{\\omega: X(\\omega) \\le x\\}$ pertence à $\\sigma$-álgebra $\\mathcal{F}$ e, portanto, $X$ é variável aleatória.\n\n**Exemplo** (@mood1974introduction) Assuma um experimento de lançar dois dados honestos de seis lados, sendo o dado $i$ e o dado $j$. Defina a variável aleatória $X$ assumir o valor da soma das suas faces, ou seja, $X(\\omega) = i+j$, onde $\\Omega = \\{(i,j): i,j = 1, 2,...,6\\}$\n\n**Definição** *Função de Distribuição Acumulada (FDA)* A FDA de uma V.A. $X$ aplicada no ponto $x$ denotada por $F_X(x)$, é uma função com domínio nos números reais e imagem (contra domínio) no intervalo $[0,1]$ que satisfaz $F_X(x) = P(X \\le x), \\forall x \\in \\mathbb{R}$.\n\nA FDA é unicamente definida para cada variável aleatória. Ou seja, uma variável aleatória $X$ possui uma única respectiva função $F_X(.)$.\n\nPara qualquer FDA de uma V.A. $X$, tem-se as seguintes propriedades:\n\n-   $0 \\le F_X(x) \\le 1$\n\n-   $F_X(x)$ é não decrescente. Isto é, se $x_1 \\le x_2 \\implies F_X(x_1) \\le F_X(x_2)$\n\n-   $F_X(-\\infty) = \\lim\\limits_{n \\to -\\infty}F_X(x) = 0$\n\n-   $F_X(+\\infty) = \\lim\\limits_{n \\to +\\infty}F_X(x) = 1$\n\nUm ponto interessante é que a definição de uma FDA poderia ser dada simplesmente por essas propriedades. Isto é, qualquer função $F(.)$ que respeite as propriedades acima **será FDA de alguma variável aleatória existente** (mesmo sem mencioná-la!).\n\n# Funções Densidade\n\nA FDA vista anteriormente possui uma definição genérica podendo englobar todo o tipo de variável aleatória. No entanto, os valoes específicos da sua distribuição podem também ser descritos através da *função de densidade de probabilidade*. Para isso, vamos considerar o caso de variáveis *discretas* e *contínuas*.\n\n## Variáveis Aleatórias Discretas\n\n**Definição** Se os valores considerados de $X$ são **contáveis**, então $X$ é considerado *discreto*.\n\nNote que se $X$ é contável assumindo, por exemplo, valores $x_1, x_2, ..., x_n, ...$, então $\\Omega = \\bigcup\\limits_{i=1}^{\\infty} \\{X = x_n\\}$, mas como os $x_i$'s podem ser vistos como eventos disjuntos, isto é, $\\{X = x_i\\} \\cap \\{X = x_j\\} = \\emptyset, \\forall i \\ne j$; então, $1 = P(\\Omega) = \\sum\\limits_{i=1}^{\\infty}P(X = x_i)$ pelo **terceiro axioma** de Kolmogorov.\n\nA função densidade de probabilidade, $f_X(.)$ é definida como sendo\n\n$$\n\\begin{align*}\nf_X(x) &= \n\\begin{cases}\n  P(X = x_i), & \\text{se}\\ x=x_i,\\ i = 1, 2, ...  \\\\\n  0, & \\text{caso contrário}\n\\end{cases}\n\\end{align*}\n$$\n\nA função densidade de probabilidade de uma VA discreta também pode ser chamada de *função massa de probabilidade*.\n\n**Exemplo** Função de densidade do lançamento de um dado honesto sendo $X$ definido como sendo o **valor da face**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar o pacote ggplot2\nlibrary(ggplot2)\n\n# Dados: resultados do dado e suas probabilidades\ndados <- data.frame(\n  face = 1:6,\n  probabilidade = rep(1/6, 6),\n  fracoes = '1/6'\n)\n\n# Criar o gráfico de barras\nggplot(dados, aes(x = factor(face), y = probabilidade)) +\n  geom_bar(stat = \"identity\", fill = \"#2780e3\") +\n  geom_text(aes(label = fracoes), vjust = -0.5, size = 4) +\n  labs(title = \"Função Massa de Probabilidade de um Dado Honesto\",\n       x = \"Face do Dado\",\n       y = \"Probabilidade\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](5_variaveis_aleatorias_conceitos_basicos_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n\nObserve que, neste caso, a FDA pode ser visualizada abaixo:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Código inspirado em https://stackoverflow.com/questions/52236576/r-ggplot-make-geom-step-jumps-dashed\n\n# Carregar as bibliotecas necessárias\nlibrary(ggplot2)\nlibrary(dplyr)\n\ndados <- tibble::tibble(\n  x = 0:6,\n  probabilidade = c(0, rep(1/6, 6)),\n  fda = cumsum(probabilidade))\n\ndados_grafico <- dados %>%\n  mutate(tipo = \"fda\") %>%\n  bind_rows(dados %>%\n              mutate(tipo = \"previa_fda\",\n                     fda = lag(fda))) %>%\n  tidyr::drop_na() %>%\n  arrange(x, desc(tipo))\n\nggplot(dados_grafico) + \n  geom_segment(aes(x = lag(x), y = lag(fda), xend = x, yend = fda, lty = tipo)) +\n  geom_point(data = slice(dados_grafico, -1), aes(x, fda, fill = tipo), shape = 21) + # Retira ponto mais extremo para ilustrar o -infinito\n  scale_fill_manual(values = c(\"black\", \"white\")) +\n  scale_linetype_manual(values = c(\"dashed\", \"solid\")) +\n  labs(title = \"FDA teórica de um dado honesto (6 faces)\",\n       x = \"Face x\",\n       y = \"P(X ≤ x)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  geom_segment(aes(x = 6, y = 1, xend = 7, yend = 1)) # Segmento mais extremo para ilustrar o +infinito\n```\n\n::: {.cell-output-display}\n![](5_variaveis_aleatorias_conceitos_basicos_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\n\n\n**Exemplo** Função de densidade do lançamento de dois dados honestos sendo $X$ definido como sendo o **valor da soma das duas faces**.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(MASS)\n\n# Cria uma função que calcula P(X = x_i) onde x_i é a soma das duas faces\ncalcula_prob_soma <- function(soma) {\n  # Contar combinações possíveis que resultam na soma\n  combinacoes <- expand.grid(dado1=1:6, dado2=1:6)\n  total <- nrow(combinacoes)\n  resultados_validos <- sum(rowSums(combinacoes) == soma)\n  prob <- resultados_validos / total\n  return(prob)\n}\n\n# Aplica a função acima para todo o espaço amostral Omega\nsomas <- 2:12\nprobabilidades <- sapply(somas, calcula_prob_soma)\n\n# Convertendo para frações em formato string\nfracoes_str <- sapply(probabilidades, function(p) as.character(fractions(p)))\n\n# Criar data frame\ndados_somas <- data.frame(\n  soma = somas,\n  probabilidade = probabilidades,\n  fracoes = fracoes_str\n)\n\n# Plotagem\nggplot(dados_somas, aes(x = factor(soma), y = probabilidade)) +\n  geom_bar(stat = \"identity\", fill = \"#2780e3\") +\n  geom_text(aes(label = fracoes), vjust = -0.5, size = 4) +\n  labs(title = \"Função Massa de Probabilidade da Soma de Dois Dados\",\n       x = \"Soma dos Dados\",\n       y = \"Probabilidade\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](5_variaveis_aleatorias_conceitos_basicos_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n\n\nObserve que, neste caso, a FDA pode ser visualizada abaixo:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Cria uma função que calcula P(X = x_i) onde x_i é a soma das duas faces\ncalcula_prob_soma <- function(soma) {\n  # Contar combinações possíveis que resultam na soma\n  combinacoes <- expand.grid(dado1=1:6, dado2=1:6)\n  total <- nrow(combinacoes)\n  resultados_validos <- sum(rowSums(combinacoes) == soma)\n  prob <- resultados_validos / total\n  return(prob)\n}\n\n# Aplica a função acima para todo o espaço amostral Omega\nsomas <- 0:12\nprobabilidades <- sapply(somas, calcula_prob_soma)\n\n# Criar data frame\ndados_somas <- tibble::tibble(\n  soma = somas,\n  probabilidade = probabilidades,\n  fda = cumsum(probabilidade)\n) %>%\n  distinct(fda, .keep_all = T) # Evita segmentos redundantes\n\ndados_grafico <- dados_somas %>%\n  mutate(tipo = \"fda\") %>%\n  bind_rows(dados_somas %>%\n              mutate(tipo = \"previa_fda\",\n                     fda = lag(fda))) %>%\n  tidyr::drop_na() %>%\n  rename(x = soma) %>%\n  arrange(x, desc(tipo))\n\nggplot(dados_grafico) + \n  geom_segment(aes(x = lag(x), y = lag(fda), xend = x, yend = fda, lty = tipo)) +\n  geom_point(data = slice(dados_grafico, -1), aes(x, fda, fill = tipo), shape = 21) + # Retira ponto mais extremo para ilustrar o -infinito\n  scale_fill_manual(values = c(\"black\", \"white\")) +\n  scale_linetype_manual(values = c(\"dashed\", \"solid\")) +\n  labs(title = \"FDA teórica da soma de dois dados honestos\",\n       x = \"Soma das Faces\",\n       y = \"P(X ≤ x)\") +\n  theme_minimal() +\n  theme(legend.position = \"none\") +\n  scale_x_continuous(breaks = 0:13, limits = c(0, 13)) +\n  geom_segment(aes(x = 12, y = 1, xend = 13, yend = 1)) # Segmento mais extremo para ilustrar o +infinito\n```\n\n::: {.cell-output-display}\n![](5_variaveis_aleatorias_conceitos_basicos_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n## Variáveis Aleatórias Contínuas\n\n**Definição** Uma variável aleatória $X$ é dita contínua se existe uma função $f_X(.)$ tal que $F_X(x) = \\int_\\limits{-\\infty}^{x}f_{X}(u)d(u), \\forall x \\in \\mathbb{R}$. Se $X$ é contíuna, então a função $f_X(x)$ é chamada de *função densidade de probabilidade* de $X$ aplicada no ponto $x$.\n\nPara qualquer função densidade de uma V.A. $X$, contínua tem-se as seguintes propriedades:\n\n-   $f_X(x) \\ge 0, \\forall x \\in \\mathbb{R}$\n\n-   $\\int\\limits_{-\\infty}^{+\\infty}f(x)dx = 1$.\n\nUm ponto interessante é que a definição de uma função de densidade poderia ser dada simplesmente por essas propriedades. Isto é, qualquer função $f(.)$ que respeite as propriedades acima **será função de densidade de probabilidade de alguma variável aleatória existente** (mesmo sem mencioná-la!).\n\nPara obter a probabilidade de uma variável aleatória $X$ estar entre dois valores $a,b \\in \\mathbb{R}, a < b$, podemos usar as definições usuais de cálculo integral. Isto é:\n\n$P(a < X < b) = \\int\\limits_{a}^{b}f(x)dx = F_X(b) - F_X(a)$\n\nAlém disso, $P(X = a) = 0, \\forall a \\in \\mathbb{R}$.\n\nObserve que para variáveis aleatórias contínuas nos pontos $a$ e $b$, o valor da probabilidade não se altera se incluímos ou excluímos na desiguldade os valores. Isto é:\n\n$$\nP(a < X < b) = P(a \\le X < b) = P(a < X \\le b) = P(a \\le X \\le b)\n$$\n\n**Exemplo** (@mood1974introduction) Seja $X$ uma variável aleatória representando o tempo de uma conversa de telefone. Assuma que a FDA de $X$ é dada por $F_X(x) = \\left( 1 - e^{-\\lambda x} \\right), x \\ge 0$ e assuma também que $\\lambda > 0$. A função densidade de probabilidade correspondente é dada por $f_X(x) = \\lambda e^{-\\lambda x}, x \\ge 0$. Assuma que a função é dada em medidas de minutos. Então, assumindo $\\lambda = \\frac{1}{5}$, qual a probabilidade de uma ligação durar entre 5 e 10 minutos?\n\nEssa resposta pode ser dada pela função densidade:\n\n$$\nP(5 < X < 10) = \\int\\limits_{5}^{10}\\lambda e^{-\\lambda x} dx = e^{-5\\lambda}-e^{-10\\lambda} = e^{-1}-e^{-2} \\approx 0.23\n$$\n\nOu também pela função de distribuição acumulada:\n\n$$\nP(5 < X < 10) = P(X < 10) - P(X < 5) = F_X(10) - F_X(5) = (1- e^{-\\lambda 10}) -  (1- e^{-\\lambda 5}) = e^{-1} - e^{-2}  \\approx 0.23\n$$\n\nAbaixo podemos ver a representação gráfica do valor dessa probabilidade:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(ggplot2)\n\nvalor_lambda <- 1 / 5\nlower_bound <- 5\nupper_bound <- 10\n\n# Obs: a função interna do R possui a mesma parametrização de Mood e Graybill\n# De qualquer forma, poderíamos criar a nossa própria versão da exponencial como por exemplo:\n# dexp_2 <- function(x, lambda) {ifelse(x >= 0, lambda * exp(-lambda * x), 0)}\n\nx_values <- seq(0, 12, by = 0.01) # Ajustar à gosto\nexp_data <- data.frame(x = x_values, y = dexp(x_values, rate = valor_lambda))\n\nshaded_area_data <- subset(exp_data, x >= lower_bound & x <= upper_bound)\nshaded_area_data <- rbind(c(lower_bound, 0), shaded_area_data, c(upper_bound, 0))\n\nggplot(exp_data, aes(x = x, y = y)) +\n  geom_line(color = \"blue\") + # Densidade de Probabilidade\n  geom_polygon(data = shaded_area_data, aes(x = x, y = y), fill = \"red\", alpha = 0.5) + # Área Hachurada\n  labs(title = substitute(paste(\"Função Densidade de Probabilidade (\",lambda,\" = \", x , \")\"), list(x = valor_lambda)), # Não pode ser paste0\n       x = \"x\",\n       y = \"Valor da Densidade f(x)\") +\n  ylim(c(0,1)) +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](5_variaveis_aleatorias_conceitos_basicos_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "5_variaveis_aleatorias_conceitos_basicos_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}