{
  "hash": "a078e9a55aed010ad840a0b006926417",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Lei dos Grandes Números\"\nlang: pt # Equações ficarem referenciadas em Português\n#sidebar: probabilidades\n\ntoc: true\ntoc-title: \"Nesta página\"\n#toc-location: right-body\ntoc-location: right\n\nexecute: \n  warning: false\n  message: false\n\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Mostrar Código\"\n---\n\n\n\n\n# Introdução e Condições Iniciais\n\nA Lei dos Grandes Números (LGN) é um dos resultados mais famosos da Teoria da Probabilidade.\n\nSejam $X_1, X_2, ...$ variáveis aleatórias independentes e identicamente distribuídas ($iid$) com média e variância existentes e finitas, isto é $-\\infty < \\mu < +\\infty$ e $0 < \\sigma^2 < +\\infty$.\n\nAlém disso, defina $\\bar{X} = \\frac{\\sum_{i=1}^{n}{X_i}}{n}$ como sendo a média amostral.\n\n## Lei Forte dos Grandes Números\n\nA Lei Forte estabelece que a média amostral converge para $\\mu$ no infinito com probabilidade 1. Ou seja, $\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu$ com probabilidade 1.\n\nObserve que $\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu$ é um **evento**. Logo, a Lei Forte poderia ser reescrita com uma notação probabilística alternativa:\n\n$$P\\left(\\bar{X} \\xrightarrow{n \\rightarrow + \\infty} \\mu \\right) = 1$$\n\nEste resultado estabelece que $\\bar{X}$ converge *quase certamente* para $\\mu$. Podemos interpretar esse resultado como sendo *à medida que n cresce, no infinito,* $\\bar{X}$ e $\\mu$ serão iguais. Ou seja, é uma convergência pontual do valor de uma variável aleatória (a média amostral) para uma constante (a média populacional).\n\nA prova deste teorema implica em provar que o evento acima é um evento de probabilidade 1, o que exige maior formalidade matemática fazendo uso do [Lema de Borel-Cantelli](https://pt.wikipedia.org/wiki/Lema_de_Borel-Cantelli).\n\n**Prova.** Ver Cáp. 5 de @barryjames2023.\n\n$\\square$\n\n## Lei Fraca dos Grandes Números\n\nA Lei Fraca estabelece que $\\forall \\varepsilon > 0$, então:\n\n$$P\\left(\\left| \\bar{X} - \\mu \\right| \\ge \\varepsilon \\right) \\xrightarrow{n \\rightarrow + \\infty} 0$$\n\nEste resultado estabelece que $\\bar{X}$ converge *em probabilidade* para $\\mu$.\n\n**Prova.** A prova faz uso da [Desigualdade de Chebyshev](https://pt.wikipedia.org/wiki/Desigualdade_de_Chebyshev):\n\n$$\n\\begin{align*}\nP\\left(\\left| \\bar{X} - \\mu \\right| \\ge \\varepsilon \\right) \\overset{\\text{Des. Cheb.}}{\\le} \\frac{Var(\\bar{X})}{\\varepsilon^2} = \\frac{Var\\left(\\frac{\\sum_{i=1}^{n}{X_i}}{n}\\right)}{\\varepsilon^2} \\overset{\\text{Prop. da Constante}}{=} \\frac{Var(\\sum_{i=1}^{n}{X_i})}{n^2\\varepsilon^2} \\overset{\\text{Indep.}}{=} \\\\ \n= \\frac{\\sum_{i=1}^{n}{Var(X_i)}}{n^2\\varepsilon^2} \\overset{\\text{Ident. Dist.}}{=} \\frac{n\\sigma^2}{n^2\\varepsilon^2} = \\frac{\\sigma^2}{n\\varepsilon^2} \\xrightarrow{n \\rightarrow + \\infty} 0\n\\end{align*}\n$$\n\n$\\square$\n\nEste resultado ilustra que $\\bar{X}$ converge *em probabilidade* para $\\mu$. Podemos interpretar esse resultado como sendo *à medida que n cresce, é extremamente improvável que a diferença entre* $\\bar{X}$ *e* $\\mu$ *seja maior que* $\\varepsilon$.\n\n## Relação entre Leis e Convergências\n\nÉ intuitivo pensar afirmarmos que duas quantidades são **iguais** é mais \"forte\" do que dizer que essas duas quantidades são \"altamente prováveis de **estarem próximas**\". Ora, se uma coisa é igual à outra, isso implica de que elas também são próximas. Tendo em vista que a Lei Forte dos Grandes Números representa a convergência *quase certa* e a Lei Fraca representa a convergência *em probabilidade*, temos que se\n\n$$Convergência\\ Quase\\ Certa \\implies Convergência\\ em\\ Probabilidade$$\n\nentão,\n\n$$Lei\\ Forte \\implies Lei\\ Fraca$$\n\nO contrário não vale para nenhuma das duas afirmativas acima.\n\n## Exemplo: O caso Bernoulli\n\nSuponha uma sequência independente de lançamentos de uma moeda honesta e a variável aleatória $X_i = 1$ se cara e $X_i = 0$ se coroa. Ou seja,\n\n$$X_i \\overset{iid}{\\sim}Bernoulli(p)$$\n\nonde $p = 0,5$. Então, pela Lei Forte dos Grandes Números:\n\n$$\\bar{X} = \\frac{\\sum_{i=1}^{n}{X_i}}{n} \\xrightarrow{n \\rightarrow + \\infty} p$$\n\nEste resultado mostra que a medida que ao jogarmos a moeda infinitas vezes, iremos convergir para um cenário em que metade dos lançamentos serão caras e metade serão coroas. Note que o resultado vale quando $n \\rightarrow + \\infty$, ou seja, ele não estabelece nada em uma quantidade finita de lançamentos onde pode existir variabilidade. Por exemplo, mesmo que seja altamente improvável que nos primeiros 100 lançamentos todos os resultados sejam a face \"Cara\", não existe nada matematicamente que estabeleça que isso seja impossível. No entanto, no limite do infinito as quantidades iniciais serão \"engolidas\" pela LGN. Para uma discussão mais aprofundada sobre esse tema recomenda-se uma leitura sobre o [Gambler's Fallacy](https://en.wikipedia.org/wiki/Gambler%27s_fallacy).\n\n## Exemplo Computacional\n\nNo R:\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Carregar as bibliotecas necessárias\nlibrary(ggplot2)\nlibrary(dplyr)\n\n# Definir o número de lançamentos\nn <- 500\n\n# Simular lançamentos de uma moeda honesta\nset.seed(123) # Para reprodutibilidade\nlancamentos <- sample(c(\"Cara\", \"Coroa\"), n, replace = TRUE)\n\n# Calcular a proporção acumulada de caras\ndados <- data.frame(lancamentos) %>%\n  mutate(\n    n = row_number(),\n    proporcao_cara = cumsum(lancamentos == \"Cara\") / n\n  )\n\n# Criar o gráfico\nggplot(dados, aes(x = n, y = proporcao_cara)) +\n  geom_line(color = \"blue\") +\n  labs(title = \"Lei dos Grandes Números: Lançamento de uma Moeda Honesta\",\n       x = \"Número de Lançamentos\",\n       y = \"Proporção de Caras\") +\n  geom_hline(yintercept = 0.5, linetype = \"dashed\", color = \"red\") +\n  theme_minimal()\n```\n\n::: {.cell-output-display}\n![](LGN_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n\n\n\nNo Python:\n\n\n\n\n::: {.cell}\n\n```{.python .cell-code}\nimport numpy as np\nimport matplotlib.pyplot as plt\n\n# Definindo o número de lançamentos\nn = 500\n\n# Simulando lançamentos de uma moeda honesta\nnp.random.seed(123)  # Para reprodutibilidade\nlancamentos = np.random.choice(['Cara', 'Coroa'], size=n)\n\n# Calculando a proporção acumulada de caras\nproporcao_cara = np.cumsum(lancamentos == 'Cara') / np.arange(1, n + 1)\n\n# Criando o gráfico\nplt.figure(figsize=(6, 4))\nplt.plot(proporcao_cara, color='blue', label='Proporção de Caras')\nplt.axhline(y=0.5, color='red', linestyle='--', label='Proporção Esperada (0.5)')\nplt.title('Lei dos Grandes Números: Lançamento de uma Moeda Honesta')\nplt.xlabel('Número de Lançamentos')\nplt.ylabel('Proporção de Caras')\nplt.legend()\nplt.grid()\nplt.show()\n```\n\n::: {.cell-output-display}\n![](LGN_files/figure-html/unnamed-chunk-2-1.png){width=576}\n:::\n:::\n\n\n\n\n# Links Úteis\n\n[Aula de Harvard de Lei dos Grandes Números e Teorema Central do Limite](https://www.youtube.com/watch?v=OprNqnHsVIA&t=1910s)\n\n[Página da Wikipedia da Lei dos Grandes Números](https://en.wikipedia.org/wiki/Law_of_large_numbers)\n",
    "supporting": [
      "LGN_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}